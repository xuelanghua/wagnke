<!doctype html>
<html>

	<head>
		<meta charset="utf-8">
		<title>编辑文章</title>
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover">
		<link href="../css/mui.css" rel="stylesheet" />
		<link href="../plugins/eleditor/base.css" rel="stylesheet" />
		<style>
			*{
			margin: 0;
			padding: 0;
			}
			body {
				-webkit-touch-callout: none;
				background-color: #fff;
				line-height: inherit;
				padding-top: 30px;
			}
			#contentEditor{
				width: 100%;
				min-height: 300px;
				box-sizing: border-box;
				padding: 10px;
				color: #444;
			}
			#contentEditor p{
				letter-spacing: 0.25px;
				font: 16px/25px Tahoma, Verdana, 宋体;
				margin: 20px 0px;
			}
			#contentEditor h4 {
				font-weight: bold;
				line-height: 1.333em;
				margin: 10px 0 20px;
				padding: 25px 0 0;
			}
			#contentEditor img{
				width: 100%;
				height: auto;
				box-sizing: border-box;
			}
			.dempTip{
				border-left: 2px solid #00BCD4;
				padding-left: 5px;
				margin: 10px;
				font-size: 16px;
			}
			code{
				white-space: pre-wrap;
				background: #2D2D2D;
				display: block;
				margin: 10px;
				border-radius: 5px;
				color: #fff;
			}
			.viewTit{
				color: #FF5722;
				position: fixed;
				top: 0;
				left: 0;
				height: 30px;
				line-height: 30px;
				font-size: 14px;
				text-align: center;
				display: block;
				width: 100%;
				background: #FFEB3B;
				box-shadow: 0 0 5px;
			}
			
			#confirm {
				width: 50px;
				height: 44px;
				line-height: 44px;
				text-align: center;
				font-size: 16px;
			}
			
			[v-cloak] {
				display: none;
			}
		</style>
	</head>

	<body>
		<header class="mui-bar mui-bar-nav">
			<div class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></div>
			<h1 class="mui-title">编辑文章</h1>
			<div class="mui-pull-right" id="confirm">确定</div>
		</header>
		<div class="mui-content" id="contentEditor" v-cloak></div>
	</body>
	<script src="../js/mui.js"></script>
	<script src="../js/util.js"></script>
	<script src="../js/Zepto.min.js"></script>
	<script src="../plugins/eleditor/webuploader.min.js"></script>
	<script src="../plugins/eleditor/Eleditor.js"></script>
	<script type="text/javascript">
		mui.init({
			swipeBack: true
		})
		
		var userInfo = getUserInfo();
		var contentEditor = new Eleditor({
			el: '#contentEditor',
			upload: {
				server: $uploadUrl,
				formName: 'file',
				formData: {
					'token': userInfo.token
				},
				compress: false,
				fileSizeLimit: 4
			},
			changer: function() {
				console.log('文档修改');
			},
			/*自定义按钮的例子*/
			toolbars: [
				'insertText',
				'editText',
				'insertImage',
				'insertLink',
				'insertHr',
				'delete',
				'undo',
				'cancel'
			]
			//placeHolder: 'placeHolder设置占位符'
		});
		
		mui.plusReady(function() {
			var self = plus.webview.currentWebview();
			if (self.content.length != 0) {
				document.getElementById('contentEditor').innerHTML = self.content;
			}
			document.getElementById('confirm').addEventListener('tap', function() {
				var content = document.getElementById('contentEditor').innerHTML;
				if (content == '<p class="Eleditor-placeholder">点击此处编辑内容</p>') {
					content = '';
				}
				mui.fire(plus.webview.getWebviewById('publish_article'), 'editDetail', {content: content});
				mui.back();
			})
		})
	</script> 
</html>
