<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<title>会员中心</title>
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover">
		<link href="../css/mui.min.css" rel="stylesheet" />
		<link href="../icomoon/style.css" type="text/css" rel="stylesheet" />
		<style>
			.my-equity{
				height: 100%;
				width: auto;
				padding: 0 10px;
				margin-right: -10px;
				font-size: 14px;
				position: relative;
				z-index: 12;
				display: flex;
				align-items: center;
				justify-content: center;
				color: #333333;
			}
			.maker-head{
				height: 6.45rem;
				width: 100%;
				background: #FFFFFF url("../image/maker.jpg")center top no-repeat;
				background-size: contain;
				margin-bottom: 0.15rem;
				padding: 0 0.2rem;
			}
			.first-section{
				width: 100%;
				height: 4.5rem;
				padding: 1.08rem 0.36rem 0 0.78rem;
				box-sizing: border-box;
				overflow: hidden;
			}
			.first-section h2{
				font-size: 0.56rem;
				color: #856c22;
				font-weight: normal;
			}
			.first-section .wangwang{
				font-size: 0.24rem;
				color: #856c22;
				display: flex;
				align-items: center;
				margin: 0.15rem 0 0.5rem;
			}
			.first-section .wangwang img{
				width: 0.24rem;
				height: 0.24rem;
			}
			.first-section .wangwang span{
				display: inline-flex;
				margin: 0 0.1rem;
			}
			.card-bottom{
				display: flex;
				align-items: center;
				justify-content: space-between;
				overflow: hidden;
				padding: 0.2rem 0;
			}
			.card-bottom span{
				font-size: 0.2rem;
				color: #856c22;
			}
			
			.card-bottom .left-btn,.card-bottom .right-btn{
				display: inline-flex;
				border-radius: 0.17rem;
				background-color: #f0dba2;
				width: 1.24rem;
				height: 0.35rem;
				border:0.01rem solid #856c22;
				margin-left: 0.2rem;
				font-size: 0.2rem;
				align-items: center;
				justify-content: center;
				padding-top: 0.05rem;
			}
			.card-bottom .right-btn{
				border: none;
				width: auto;
				height: auto;
				font-size: 0.3rem;
				padding-left:0.2rem;
				padding-right:0.2rem;
				border-right: none;
				margin-right: -0.1rem;
				border-radius: 0.3rem;
				border-top-right-radius: 0;
				border-bottom-right-radius: 0;
				box-shadow: 0 0 2px 2px rgba(133,108,34,0.2);
			}
			.bonus-section{
				width: 100%;
				height: 1.5rem;
				box-shadow: 0 0 10px 5px rgba(0,0,0,0.1);
				overflow: hidden;
				border-radius: 0.1rem;
				display: flex;
				align-content: center;
				justify-content: center;
			}
			.items {
				flex-grow: 1;
				text-align: center;
				position: relative;
				padding-top: 0.3rem;
			}
			.items span{
				display: inline-flex;
				padding-right:0.4rem;
				position: relative;
				color: #000000;
				font-size: 0.24rem;
				margin-bottom: 0.1rem;
			}
			.items p{
				color: #856c22;
				font-size: 0.35rem;
				margin-bottom: 0;
				text-align: center;
			}
			.items .unit{
				font-size: 0.24rem;
				color: #999999;
				margin-left: 0.05rem;
				margin-bottom: 0;
				padding: 0;
			}
			.mui-navigate-right:after{
				right: 0;
				font-size: 0.36rem;
				color: #999999;
				top: 50%;
				-webkit-transform: translateY(-51%);
				transform: translateY(-50%);
			}
			.items:first-of-type:after{
				content: '';
				width: 1px;
				height: 0.55rem;
				top: 50%;
				right: 0;
				position: absolute;
				transform: translateY(-50%);
				-webkit-transform: translateY(-50%);
				background-color: #dddddd;
			}
			.fans{
				background-color: #FFFFFF;
				position: relative;
				overflow: hidden;
				padding-bottom: 50px;
			}
			.fans .title{
				height: 1.14rem;
				margin: 0;
				display: flex;
				align-items: center;
				position: relative;
				justify-content: flex-start;
				padding: 0 0.4rem 0 0.2rem;
				font-size:0.3rem;
				position: relative;
			}
			.fans .title:after{
				content: '';
				height: 1px;
				display: block;
				position: absolute;
				bottom: 0;
				width: 100%;
				background-color: #DDDDDD;
				left: 0;
			}
			.fans .title:before{
				content: '';
				display: inline-block;
				width: 4px;
				height: 15px;
				background-color: #2289ff;
				margin-right: 5px;
			}
			.fans .title span:last-of-type{
				color: #999999;
			}
			.fans .mui-table-view-cell{
				display: flex;
				align-items: center;
				justify-content: space-between;
			}
			.user-head-img{
				width: 0.75rem;
				height: 0.75rem;
				border-radius: 50%;
				margin-right: 0.2rem;
				flex-shrink: 0;
			}
			.fans .mui-table-view-cell{
				height: 1.58rem;
				padding: 0 0.2rem;
			}
			.fans .mui-table-view-cell span{
				font-size: 0.3rem;
				color: #333333;
			}
			.flex-right{
				flex-grow: 1;
			}
			.flex-right .mui-clearfix{
				margin-bottom: 0.2rem;
				overflow: hidden;
			}
			.mui-table-view-cell:after{
				left: 1rem;
			}
			
			.fans .mui-table-view-cell .create-time,.fans .mui-table-view-cell .person{
				color: #999999;
				font-size: 0.24rem;
			}
			.fans .mui-table-view-cell:after{
				height: 1;
			}
			.mui-table-view-cell .flex-right .vip,.mui-table-view-cell .flex-right .vip1{
				padding: 0.05rem 0.16rem 0.02rem;
				font-size: 0.2rem;
				color: #FFFFFF;
				margin-left: 0.2rem;
				border-bottom-left-radius: 0.2rem;
				border-top-right-radius: 0.2rem;
				background: linear-gradient(to right, #B7C4DC , #8A9BB9);
			}
			.mui-table-view-cell .flex-right .vip1{
				background: linear-gradient(to right, #F3E3B9 , #E9CB7D);
			}
			[v-cloak] {
			  display: none;
			}
			.first-section .referrers{
				font-size: 0.2rem;
				background-color: #c7b274;
				padding: 3px 6px;
				border-radius: 10px;
				color: #FFFFFF;
				line-height: 1;
				margin-left: 5px;
			}
			.fans-classify{
				margin: 15px;
				width: 94%;
				margin-left: 3%;
				box-shadow: 0 0 6px 0 rgba(0,0,0,0.1);
				height: 75px;
				border-radius:10px;
				background-color: #FFFFFF;
				padding: 10px;
				overflow: hidden;
				display: flex;
				align-items: center;
				position: relative;
			}
			.fans-num-title,.fans-total,.my-fans-total{
				height: 100%;
				display: flex;
				align-items: center;
				justify-content: center;
				position: relative;
				font-size: 15px;
			}
			.fans-classify p{
				margin-bottom: 0;
				font-size: 13px;
			}
			.fans-num-title{
				width:25%;
				/* background-color: #007AFF; */
				justify-content: flex-start;
			}
			.fans-num-title img{
				height:100%;
				position:absolute;
				right: 0;
			}
			.fans-total{
				width:40%;
				/* background-color: #00BCD4; */
			}
			.my-fans-total{
				width:35%;
				/* background-color: #00CCFF; */
			}
			.my-fans-total:before{
				position: absolute;
				content: '';
				display: block;
				width: 1px;
				height:50%;
				top: 25%;
				left: 10px;
				background-color: #DDDDDD;
				-webkit-transform: scaleX(0.5);
				transform: scaleX(0.5);
			}
			.inside{
				text-align: center;
			}
			.inside.mui-navigate-right:after{
				right: -10px;
				font-size: 26px;
				color: #DDDDDD;
			}
		</style>
		<script type="text/javascript">
			// 初始化字体大小
			var viewport = document.documentElement.clientWidth;
			if (viewport > 750) {
				viewport = 750
			}
			document.documentElement.style.fontSize = viewport / 7.5 + "px";

			// 初始化字体大小结束
		</script>
	</head>

	<body>
		<header class="mui-bar mui-bar-nav">
			<div class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></div>
			<h1 class="mui-title">会员中心</h1>
			<div class="mui-pull-right my-equity">我的权益</div>
		</header>

		<div id="mui-content" class="mui-content setting-container" v-cloak>
			<div class="maker-head">
				<div class="first-section">
					<h2>{{memberInfo.group_name}}<span v-if="memberInfo.recommend_name!=''" class="referrers">推荐人：{{memberInfo.recommend_name}}</span></h2>
					<div class="wangwang"><span class="icon-wangwang"></span><span>旺旺</span>{{memberInfo.wang || 0}}</div>
					<div class="card-bottom">
						<div>
							<span>到期：{{memberInfo.expire_time}}</span><span class="left-btn" id="renew">续费/升级</span>
						</div>
						<span class="right-btn" v-if="memberInfo.activation_code!='0/0'" @tap="goCodeList">{{memberInfo.activation_code}}</span>
						<span class="right-btn" v-else @tap="exchangeCode">激活码</span>
					</div>
				</div>
				<div class="bonus-section">
					<div class="items service-award">
						<span class="mui-navigate-right">本月服务奖</span>
						<p>{{memberInfo.service_award || 0 }}<span class="unit">元</span></p>
					</div>
					<div class="items award-reward">
						<span class="mui-navigate-right">推荐奖累计</span>
						<p>{{memberInfo.recommended_award}}<span class="unit">元</span></p>
					</div>
				</div>
			</div>
			<div class="fans">
				<div class="title">我的粉丝</div>
				<div class="fans-classify" data-gid="1">
					<div class="fans-num-title">
						VIP
						<img src="../image/fans-title-border.png">
					</div>
					<div class="fans-total">
						<div class="inside">
							<p>粉丝总数</p>
							<span>{{fans_info.vip.total}}</span>
						</div>
					</div>
					<div class="my-fans-total">
						<div class="inside mui-navigate-right">
							<p>我的粉丝</p>
							<span>{{fans_info.vip.mine}}</span>
						</div>
					</div>
				</div>
				<div class="fans-classify" data-gid="2">
					<div class="fans-num-title">
						创客
						<img src="../image/fans-title-border.png">
					</div>
					<div class="fans-total">
						<div class="inside">
							<p>粉丝总数</p>
							<span>{{fans_info.maker.total}}</span>
						</div>
					</div>
					<div class="my-fans-total">
						<div class="inside mui-navigate-right">
							<p>我的粉丝</p>
							<span>{{fans_info.maker.mine}}</span>
						</div>
					</div>
				</div>
				<div class="fans-classify" data-gid="3">
					<div class="fans-num-title">
						服务站
						<img src="../image/fans-title-border.png">
					</div>
					<div class="fans-total">
						<div class="inside">
							<p>粉丝总数</p>
							<span>{{fans_info.service_station.total}}</span>
						</div>
					</div>
					<div class="my-fans-total">
						<div class="inside mui-navigate-right">
							<p>我的粉丝</p>
							<span>{{fans_info.service_station.mine}}</span>
						</div>
					</div>
				</div>
				<div class="fans-classify" data-gid="4">
					<div class="fans-num-title">
						服务中心
						<img src="../image/fans-title-border.png">
					</div>
					<div class="fans-total">
						<div class="inside">
							<p>粉丝总数</p>
							<span>{{fans_info.service_center.total}}</span>
						</div>
					</div>
					<div class="my-fans-total">
						<div class="inside mui-navigate-right">
							<p>我的粉丝</p>
							<span>{{fans_info.service_center.mine}}</span>
						</div>
					</div>
				</div>
				<div class="fans-classify" data-gid="5">
					<div class="fans-num-title">
						分公司
						<img src="../image/fans-title-border.png">
					</div>
					<div class="fans-total">
						<div class="inside">
							<p>粉丝总数</p>
							<span>{{fans_info.filiale.total}}</span>
						</div>
					</div>
					<div class="my-fans-total">
						<div class="inside mui-navigate-right">
							<p>我的粉丝</p>
							<span>{{fans_info.filiale.mine}}</span>
						</div>
					</div>
				</div>
			</div>
		</div>
		<script src="../js/mui.min.js"></script>
		<script src="../js/util.js"></script>
		<script src="../js/vue.min.js"></script>
		<script type="text/javascript">
			mui.init({
				swipeBack: true
			});
			mui.plusReady(function() {})
			var userInfo = getUserInfo(),
				pageNum = 0;
			var app = new Vue({
				el: "#mui-content",
				data: {
					group_id: '',
					fans_info: {
						vip: {
							mine: 0,
							total: 0
						},
						maker: {
							mine: 0,
							total: 0
						},
						service_station: {
							mine: 0,
							total: 0
						},
						service_center: {
							mine: 0,
							total: 0
						},
						filiale: {
							mine: 0,
							total: 0
						}
					},
					memberInfo: {
						group_name: '',
						position: '',
						expire_time: '',
						group_annual_fee: '',
						activation_code: '',
						service_award: 0,
						recommended_award: 0,
						wang: '0'
					},
					fansLists: []
				},
				created: function() {
					getFans();
					this.group_id = userInfo.group_id;
				},
				mounted: function() {
					mui.plusReady(function() {
						getMemberInfo();
						window.addEventListener('activateSuccess', function() {
							setTimeout(function() {
								getMemberInfo();
							}, 1000)
						})

						// 显示激活码
						mui(".mui-content .jihuo").on("tap", ".show-key", function() {
							openPage('activate_code.html', 'activate_code', '#ffffff', '');
						})

						// 领取激活码
						mui(".mui-content .jihuo").on("tap", ".get-key", function() {
							openPage('activation_code_collection.html', 'activation_code_collection', '#f7f7f7', '');
						})

						mui('.mui-content').on('tap', '#renew', function() {
							openPage('renew.html', 'renew', '#f7f7f7', '');
						})
						// 服务奖
						mui('.mui-content').on('tap', '.service-award', function() {
							openPage('service_award.html', 'service_award', '#f7f7f7', '');
						})
						// 粉丝
						mui('.mui-content').on('tap', '.fans-classify', function() {
							var gid = this.dataset.gid;
							openPage('my_fans.html', 'my_fans', '#f7f7f7', {
								group_id: gid
							});
						})
						// 推荐奖
						mui('.mui-content').on('tap', '.award-reward', function() {
							openPage('award_reward.html', 'award_reward', '#f7f7f7', '');
						})
						// 我的权益
						mui("header").on('tap', '.my-equity', function() {
							openPage('equities_page.html', 'equities_page', '#f7f7f7', '');
						})
						mui(".mui-content").on('tap', '.user-head-img', function() {
							var fid = this.dataset.fid;
							openPage('friends_detail.html', 'friends_detail', '#f7f7f7', {
								fid: fid
							});
						})
						mui(".mui-content").on('tap', '.flex-right', function() {
							var cid = this.dataset.cid,
								chatName = this.dataset.chatname,
								avatar = this.dataset.avatar;
							logs(cid);
							openPage('dialog.html', 'dialog', '#f7f7f7', {
								cid: cid,
								chatName: chatName,
								avatar: avatar,
								barStyle: 'dark'
							});
						})
					})
				},
				methods: {
					goCodeList: function() {
						openPage('activate_code.html', 'activate_code', '#ffffff', '');
					},
					exchangeCode: function() {
						openPage('activation_code_collection.html', 'activation_code_collection', '#f7f7f7', '');
					}
				}
			})

			function getMemberInfo() {
				mui.post($ajaxUrl + 'member&action=member_info', {
					token: userInfo.token
				}, function(res) {
					if (res.errno) {
						logs(res.message);
					} else {
						// 请求成功
						app.memberInfo = res.data;
					}
				}, 'json');
			}

			function getFans() {
				mui.post($ajaxUrl + 'member&action=fans_statistics', {
					token: userInfo.token,
				}, function(res) {
					if (res.errno == 0) {
						logs(res);
						app.fans_info = res.data;
					} else {
						// 请求成功
					}
				}, 'json');
			}
		</script>
	</body>

</html>
