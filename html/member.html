<!doctype html>
<html>

	<head>
		<meta charset="utf-8">
		<title>会员中心</title>
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover">
		<link href="../css/mui.min.css" rel="stylesheet" />
		<style>
			.mui-bar{
				background-color: #FFFFFF;
				box-shadow: none;
			}
			.mui-content,body{
				background-color: #F5F5F5;
			}
			.clearfix{
				clear: both;
			}
			.member{
				height: 208px;
				background-color: #000000;
			}
			.member_chart{
				margin: -250px auto 0;
				text-align: center;
			}
			.member_chart .member-card{
				width: 331px;
				height: auto;
				margin: 0 auto;
			}
			.member_chart img{
				width: 350px;
			}
			.member_title,.member_time{
				position: relative;
				top: 120px;
				font-size: 24px;
				color: #496187;
				text-align: left;
				padding-left: 40px;
				height: auto;
			}
			.member_time{
				top: 139px;
				font-size: 12px;
			}
			.member_chart_number,.button{
				width: 80%;
				top: 210px;
				color: #333333;
				font-size: 15px;
				margin: 0 auto;
				position: relative;
			}
			.number,.number1{
				width: 50%;
				position: relative;
				display: flex;
				align-items: center;
				justify-content: center;
			}
			.number1{
				border-left: 1px solid #999999;
			}
			.button{
				width: 40%;
				top: 240px;
				border: none;
				border-radius: 15px;
				color: #FFFFFF;
				box-shadow: 0 0 10px 5px #DDDDDD;
				background-color: #97A7C3;
			}
			
			.fans{
				font-size: 15px;
				border-top: 10px solid #e4e4e4;
				padding-bottom: 50px;
			}
			.fans .fans-title{
				height: 55px;
				margin: 0;
				display: flex;
				align-items: center;
				position: relative;
				justify-content: flex-start;
				padding: 0 20px 0 10px;
				font-size:15px;
				position: relative;
			}
			.fans .fans-title:after{
				content: '';
				height: 1px;
				display: block;
				position: absolute;
				bottom: 0;
				width: 100%;
				background-color: #DDDDDD;
				left: 0;
			}
			.fans .fans-title:before{
				content: '';
				display: inline-block;
				width: 4px;
				height: 15px;
				background-color: #2289ff;
				margin-right: 5px;
			}
			.fans_information_chart{
				width: 40px;
				height: 40px;
				margin-top: 8px;
				border-radius: 50%;
			}
			.fans_information_chart img{
				width: 100%;
				height: 100%;
				border-radius: 50%;
			}
			.vip{
				padding: 2px 10px;
				font-size: 10px;
				color: #FFFFFF;
				margin-left: 10px;
				border-bottom-left-radius: 10px;
				border-top-right-radius: 10px;
				 background: linear-gradient(to right, #B7C4DC , #8A9BB9);
			}
			.time{
				font-size: 12px;
				margin-top: 10px;
				color: #999999;
			}
			.recommender{
				font-size: 12px;
				margin-top: 32px;
				color: #999999;
			}
			.my-equity{
				height: 100%;
				width: auto;
				padding: 0 10px;
				margin-right: -10px;
				font-size: 14px;
				position: relative;
				z-index: 12;
				display: flex;
				align-items: center;
				justify-content: center;
				color: #333333;
			}
			.more-and-more.mui-navigate-right:after{
				position: relative;
				font-size: 16px;
				display: inline-block;
				margin-left: 0px;
				color: #999999;
				transform: translateY(0);
				-webkit-transform: translateY(0);
				right: 0;
				top: 0;
			}
			[v-cloak] {
				display: none;
			}
			.member_chart .referrers{
				font-size: 10px;
				background-color: #889ab7;
				padding: 3px 6px;
				border-radius: 10px;
				color: #FFFFFF;
				line-height: 1;
				margin-left: 10px;
			}
			
			.fans-classify{
				margin: 15px;
				width: 94%;
				margin-left: 3%;
				box-shadow: 0 0 6px 0 rgba(0,0,0,0.1);
				height: 75px;
				border-radius:10px;
				background-color: #FFFFFF;
				padding: 10px;
				overflow: hidden;
				display: flex;
				align-items: center;
				position: relative;
			}
			.fans-num-title,.fans-total,.my-fans-total{
				height: 100%;
				display: flex;
				align-items: center;
				justify-content: center;
				position: relative;
				font-size: 15px;
			}
			.fans-classify p{
				margin-bottom: 0;
				font-size: 13px;
			}
			.fans-num-title{
				width:25%;
				/* background-color: #007AFF; */
				justify-content: flex-start;
			}
			.fans-num-title img{
				height:100%;
				position:absolute;
				right: 0;
				top: 0;
			}
			.fans-total{
				width:40%;
				/* background-color: #00BCD4; */
			}
			.my-fans-total{
				width:35%;
				/* background-color: #00CCFF; */
			}
			.my-fans-total:before{
				position: absolute;
				content: '';
				display: block;
				width: 1px;
				height:50%;
				top: 25%;
				left: 10px;
				background-color: #DDDDDD;
				-webkit-transform: scaleX(0.5);
				transform: scaleX(0.5);
			}
			.inside{
				text-align: center;
			}
			.inside.mui-navigate-right:after{
				right: -10px;
				font-size: 26px;
				color: #DDDDDD;
			}
			
			.as-agent-section{
				display: flex;
				width: 2.26rem;
				height: 0.4rem;
				margin-top: 30px;
				margin-bottom: 10px;
				align-items: center;
				background: url("../image/icon/maker-price-bg.jpg")center center no-repeat;
				background-size: 100% 100%;
				justify-content: space-between;
				color: #FFFFFF;
				border-radius: 0.2rem;
				padding: 0 0.12rem 0 0.2rem;
				font-size: 10px;
			}
		</style>
		<script type="text/javascript">
			// 初始化字体大小
			var viewport = document.documentElement.clientWidth;
			if (viewport > 750) {
				viewport = 750
			}
			document.documentElement.style.fontSize = viewport / 7.5 + "px";
		
			// 初始化字体大小结束
		</script>
	</head>

	<body>
		<header class="mui-bar mui-bar-nav">
			<div class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></div>
			<h1 class="mui-title">会员中心</h1>
			<div class="mui-pull-right my-equity">我的权益</div>
		</header>

		<div id="mui-content" class="mui-content" v-cloak>
			<div class="member"></div>
			<div class="member_chart">
				<div class="member-card">
					<div class="member_title">{{memberInfo.group_name}}
						<span v-if="memberInfo.recommend_name!=''" class="referrers">推荐人：{{memberInfo.recommend_name}}</span>
					</div>
					<div v-if="memberInfo.is_agency==0" class="as-agent-section">
						<span>
							&yen;100
						</span>
						<span>
							成为代理
						</span>
					</div>
					<div class="member_time">
						<span>到期：</span>
						<span>{{memberInfo.expire_time}}</span>
					</div>
				</div>
				<div class="member_chart_number">
					<div class="mui-pull-left number">
						<span>我的粉丝</span>
						<span>{{memberInfo.fans_number||0}}</span>
						<span class="more-and-more mui-navigate-right"></span>
					</div>
					<div class="mui-pull-right number1">
						<span>推荐奖累计</span>
						<span>{{memberInfo.recommended_award||'0'}}</span>
						<span class="more-and-more mui-navigate-right"></span>
					</div>
					<div class="clearfix"></div>
				</div>
				<button class="button">续费/升级</button>
				<img src="../image/member1.png">
			</div>
			<div class="fans">
				<div class="fans-title">我的粉丝</div>
				<div class="fans-classify" data-gid="1">
					<div class="fans-num-title">
						个人版
						<img src="../image/fans-title-border.png">
					</div>
					<div class="fans-total">
						<div class="inside">
							<p>粉丝总数</p>
							<span>{{fans_info.vip.total}}</span>
						</div>
					</div>
					<div class="my-fans-total">
						<div class="inside mui-navigate-right">
							<p>我的粉丝</p>
							<span>{{fans_info.vip.mine}}</span>
						</div>
					</div>
				</div>
				<div class="fans-classify" data-gid="2">
					<div class="fans-num-title">
						企业版
						<img src="../image/fans-title-border.png">
					</div>
					<div class="fans-total">
						<div class="inside">
							<p>粉丝总数</p>
							<span>{{fans_info.maker.total}}</span>
						</div>
					</div>
					<div class="my-fans-total">
						<div class="inside mui-navigate-right">
							<p>我的粉丝</p>
							<span>{{fans_info.maker.mine}}</span>
						</div>
					</div>
				</div>
				<div class="fans-classify mui-hidden" data-gid="3">
					<div class="fans-num-title">
						服务站
						<img src="../image/fans-title-border.png">
					</div>
					<div class="fans-total">
						<div class="inside">
							<p>粉丝总数</p>
							<span>{{fans_info.service_station.total}}</span>
						</div>
					</div>
					<div class="my-fans-total">
						<div class="inside mui-navigate-right">
							<p>我的粉丝</p>
							<span>{{fans_info.service_station.mine}}</span>
						</div>
					</div>
				</div>
				<div class="fans-classify mui-hidden" data-gid="4">
					<div class="fans-num-title">
						服务中心
						<img src="../image/fans-title-border.png">
					</div>
					<div class="fans-total">
						<div class="inside">
							<p>粉丝总数</p>
							<span>{{fans_info.service_center.total}}</span>
						</div>
					</div>
					<div class="my-fans-total">
						<div class="inside mui-navigate-right">
							<p>我的粉丝</p>
							<span>{{fans_info.service_center.mine}}</span>
						</div>
					</div>
				</div>
				<div class="fans-classify mui-hidden" data-gid="5">
					<div class="fans-num-title">
						分公司
						<img src="../image/fans-title-border.png">
					</div>
					<div class="fans-total">
						<div class="inside">
							<p>粉丝总数</p>
							<span>{{fans_info.filiale.total}}</span>
						</div>
					</div>
					<div class="my-fans-total">
						<div class="inside mui-navigate-right">
							<p>我的粉丝</p>
							<span>{{fans_info.filiale.mine}}</span>
						</div>
					</div>
				</div>
			</div>
		</div>
		<script src="../js/mui.min.js"></script>
		<script src="../js/vue.min.js"></script>
		<script src="../js/util.js"></script>
		<script type="text/javascript">
			mui.init({
				swipeBack: true,
				beforeback: function() {
					plus.navigator.setStatusBarStyle('light');
				}
			});
			var userInfo = getUserInfo(),
				pageNum = 0;
			var app = new Vue({
				el: "#mui-content",
				data: {
					memberInfo: {},
					fans_info: {
						vip: {
							mine: 0,
							total: 0
						},
						maker: {
							mine: 0,
							total: 0
						},
						service_station: {
							mine: 0,
							total: 0
						},
						service_center: {
							mine: 0,
							total: 0
						},
						filiale: {
							mine: 0,
							total: 0
						}
					},
				},
				mounted: function() {
					mui.init();
					mui.plusReady(function() {
						getMemberInfo();
						getFans();
						window.addEventListener('activateSuccess', function() {
							setTimeout(function() {
								getMemberInfo();
							}, 1000)
						})
						mui(".mui-content").on("tap", ".button", function() {
							openPage('renew.html', 'renew', '#f7f7f7', '');
						})

						// 跳转到粉丝页面
						mui('.mui-content').on('tap', '.fans-classify', function() {
							var gid = this.dataset.gid;
							openPage('my_fans.html', 'my_fans', '#f7f7f7', {
								group_id: gid
							});
						})

						// 推荐奖累计
						mui(".mui-content").on("tap", ".number1", function() {
							openPage('award_reward.html', 'award_reward', '#f7f7f7', '');
						})

						// 我的权益
						mui("header").on('tap', '.my-equity', function() {
							openPage('equities_page.html', 'equities_page', '#f7f7f7', '');
						})

						mui(".mui-content").on('tap', '.fans_information_chart', function() {
							var fid = this.dataset.fid;
							openPage('friends_detail.html', 'friends_detail', '#f7f7f7', {
								fid: fid
							});
						})
						mui(".mui-content").on('tap', '.flex-right', function() {
							var cid = this.dataset.cid,
								chatName = this.dataset.chatname,
								avatar = this.dataset.avatar;
							logs(cid);
							openPage('dialog.html', 'dialog', '#f7f7f7', {
								cid: cid,
								chatName: chatName,
								avatar: avatar,
								barStyle: 'dark'
							});
						})
					})
				}
			})

			function getMemberInfo() {
				mui.post($ajaxUrl + 'member&action=member_info', {
					token: userInfo.token
				}, function(res) {
					if (res.errno) {
						message(res.message);
					} else {
						// 请求成功
						app.memberInfo = res.data;
					}
				}, 'json');
			}

			function getFans() {
				mui.post($ajaxUrl + 'member&action=fans_statistics', {
					token: userInfo.token,
				}, function(res) {
					if (res.errno == 0) {
						logs(res);
						app.fans_info = res.data;
					} else {
						// 请求成功
					}
				}, 'json');
			}
		</script>
	</body>

</html>
