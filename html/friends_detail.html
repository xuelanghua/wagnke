<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>好友详情</title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link href="../css/mui.min.css" rel="stylesheet" />
		<link href="../css/vip-page.css" rel="stylesheet" />
		<link href="../css/mui.picker.min.css" rel="stylesheet" />
	</head>
	<body class="mui-hidden">
		<header class="mui-bar mui-bar-nav friends-detail-header">
			<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
			<h1 class="mui-title">胡尚</h1>
			<span class="mui-pull-right mui-icon">···</span>
		</header>
		<div id="mui-content" class="mui-content friends-detail-container">
			<!-- 名片样式一 -->
			<div class="first-card-container">
				<div class="card">
					<img class="user-head-img" src="../image/kaol.jpg">
					<div class="card-left-cont">
						<ul>
							<li id="first-row">万贤科技</li>
							<li id="second-row">胡尚</li>
							<li id="third-row">首席服务官</li>
							<li id="fourth-row">159123456789</li>
							<li id="fifth-row">send.lzp@qq.com</li>
							<li id="sixth-row">昆明市官渡区昌宏西路昆明市官渡区昌宏西路</li>
						</ul>
					</div>
				</div>
			</div>
			<!-- 名片样式一结束 -->
			<!-- 名片样式二 -->
			<div class="second-card-container mui-hidden">
				<div class="card">
					<img class="user-head-img" src="../image/kaol.jpg">
					<div class="user-info">
						<h4>胡尚</h4>
						<p>首席服务官</p>
						<p>万贤科技</p>
					</div>
				</div>
			</div>
			<!-- 名片样式二结束 -->
			<!-- 名片信息 -->
			<!-- mui-icon-arrowdown -->
			<div class="show-card-info" id="showInfo"><span id="descText">展开全部名片信息</span><i class="mui-icon mui-icon-arrowup"></i></div>
			<div class="card-info-container">
				<ul class="mui-table-view">
					<li class="mui-table-view-cell"><i>手机</i><span>13700696591</span><a href="tel:13700696591">拨打</a></li>
					<li class="mui-table-view-cell mui-hidden"><i>座机</i><span>0871-69831648</span><a href="tel:13700696591">拨打</a></li>
					<li class="mui-table-view-cell"><i>微信</i><span>13700696591</span><a href="javascript:void(0)" @tap="copy_fun('13700696591')">复制</a></li>
					<li class="mui-table-view-cell mui-hidden"><i>邮箱</i><span>2913626209@qq.com</span><a>复制</a></li>
					<li class="mui-table-view-cell"><i>公司</i><span>云南万贤科技有限公司</span><a href="javascript:void(0)" @tap="copy_fun('云南万贤科技有限公司')">复制</a></li>
					<li class="mui-table-view-cell"><i>地址</i><span>昆明市官渡区昌宏西路高原明珠商务中心A座707</span></li>
				</ul>
			</div>
			<div class="operation-btn-cont">
				<button type="button">分享名片</button>
				<button type="button" @tap="addAddressList">同步到通讯录</button>
			</div>
			<!-- 浏览记录 -->
			<div class="browse-record">
				<div class="browse-record-left">
					<ul class="browse-record-img-cont">
						<li class="browse-record-img">
							<img src="../image/kaol.jpg" alt="">
						</li>
						<li class="browse-record-img">
							<img src="../image/kaol.jpg" alt="">
						</li>
						<li class="browse-record-img">
							<img src="../image/kaol.jpg" alt="">
						</li>
						<li class="browse-record-img">
							<img src="../image/kaol.jpg" alt="">
						</li>
						<span>···</span>
					</ul>
					<p>最近5人浏览</p>
				</div>
				<div id="reliable-btn" class="browse-record-right">
					<span class="click-heart"></span>
					<span>靠谱:0</span>
				</div>
			</div>
			<h5 class="personality-desc">个性签名</h5>
			<div class="personality-cont">
				<p>越努力越幸运越努力越幸运越努力越幸运越努力越幸运越努力越幸运越努力越幸运</p>
				<div class="user-info">
					<div class="user-head-img"><img src="../image/kaol.jpg"></div>
					<!-- 添加 play是播放状态的图标-->
					<div id="audio-control" class="play-control">
						<div class="left-arrow"></div>
						<i class="play-status"></i>
						<div class="right-info mui-pull-right">
							<i></i>
							<span id="timer-num">30</span>
						</div>
					</div>
					<div class="click-agree">
						<span class="agree-icon"></span>
						<span>点赞</span>
					</div>
				</div>
			</div>
			<h5 class="personality-desc">主推商品</h5>
			<div class="goods-window">
				<ul class="goods-lists">
					<li class="goods-item">
						<div class="goods-img">
							<img src="../image/kaol.jpg">
						</div>
						<div class="goods-desc">
							<p class="goods-title">旺课，旺课旺课旺课旺课旺课旺课旺课旺课旺课旺课旺课旺课旺课旺课旺课旺课旺课旺课旺课旺课</p>
							<p class="spec">规格：默认</p>
							<p class="price">&yen;<span id="goods-price">20.00</span></p>
						</div>
					</li>
					<li class="goods-item">
						<div class="goods-img">
							<img src="../image/kaol.jpg">
						</div>
						<div class="goods-desc">
							<p class="goods-title">旺课，旺课旺课旺课旺课旺课旺课旺课旺课旺课旺课旺课旺课旺课旺课旺课旺课旺课旺课旺课旺课</p>
							<p class="spec">规格：默认</p>
							<p class="price">&yen;<span id="goods-price">20.00</span></p>
						</div>
					</li>
				</ul>
			</div>
			<h5 class="personality-desc">图片展示</h5>
			<div class="img-show">
				<img src="../image/kaol.jpg">
			</div>
			<div class="add-friend-btn">
				<img src="../image/icon/add_friends_icon.png" class="constrain-img">
				<span>添加好友</span>
			</div>
		</div>
		<script src="../js/mui.min.js"></script>
		<script src="../js/util.js"></script>
		<script type="text/javascript" src="../js/vue.min.js"></script>
		<script src="../js/Zepto.min.js"></script>
		<script type="text/javascript">
			mui.init();
			// 初始化字体大小
			var viewport = document.documentElement.clientWidth;
			if (viewport > 750) {
				viewport = 750
			}
			document.documentElement.style.fontSize = viewport / 7.5 + "px";
			// 初始化字体大小结束
			// 跳转到更多页面
			mui(".friends-detail-header").on("tap", "span", function() {
				fnOpenWin('friends_detail_more.html', 'friends_detail_more', {
					statusbar: {
						background: '#f7f7f7'
					}
				}, '', 'slide-in-right');
			})
			// 实例化vue对象
			var muiCont = new Vue({
				el: '#mui-content',
				data: {
					dataList: [],
					voidDy: false,
					contName: "胡尚",
					phoneNum: "13700696591"
				},
				mounted: function() {}
			});
			document.getElementById("fifth-row").innerText = "2913626209@qq.com";
			// 超出文本隐藏
			var voice = null;
			var playstatus = 0;
			var audiourl = "../image/alice.mp3";
			mui.plusReady(function() {
				// 音频播放
				var audioLength=0;
				var i=0;
				var voice = plus.audio.createPlayer(audiourl);
				var timer=setInterval(function(){
					if(!audioLength){
						audioLength = parseInt(voice.duration());
						$("#timer-num").text(audioLength);
					}else{
						$("#timer-num").text(audioLength);
						clearInterval(timer);
					}
				},1000);
				mui("#mui-content").on("tap", ".play-control", function() {
					if (plus.audio == undefined) {
						message("设备没有准备好！");
						return;
					}
					if (playstatus == 0) {
						voice.play(function() {
							voice.stop();
							// 播放完成停止播放
							playstatus == 0;
							$(".play-control").removeClass("play", "pause");
						}, function(e) {
							message("播放失败");
						});
						playstatus = 1;
						$(".play-control").addClass("play");
					} else if (playstatus == 1) {
						voice.pause();
						$(".play-control").removeClass("play");
						playstatus = 2;
					} else {
						voice.resume();
						playstatus = 1;
						$(".play-control").addClass("play");
					}
				})
			})
			// 产品标题超出隐藏
			var goodsTitle = document.getElementsByClassName("goods-title");
			for (i = 0; i < goodsTitle.length; i++) {
				var txt = goodsTitle[i].innerHTML;
				if (txt.length > 20) {
					txt = txt.substring(0, 25 - 1) + "..."
					goodsTitle[i].innerHTML = txt;
				} else {
					console.log("error")
				}
			}
			// 名片地址超出隐藏
			var contain = document.getElementById("sixth-row");
			overText(contain, 10);

			function overText(tgt, num) {
				var txt = tgt.innerHTML;
				if (txt.length > num) {
					txt = txt.substring(0, num - 1) + "..."
					tgt.innerHTML = txt;
				} else {
					console.log("error")
				}
			}
			$("#showInfo").click(function() {
				$(this).find("i").toggleClass("mui-icon-arrowdown");
				var descText = $("#descText").text();
				if (descText == "展开全部名片信息") {
					$("#descText").text("收起以下名片信息");
				} else {
					$("#descText").text("展开全部名片信息");
				}
				$(".card-info-container").slideToggle();
			})
			$("body").removeClass("mui-hidden");

			mui(".friends-detail-container").on("tap", "#reliable-btn,.click-agree", function() {
				this.classList.toggle('active');
			})
			//  复制方法
			function copy_fun(copy) {
				//判断是安卓还是ios
				if (mui.os.ios) {
					//ios
					var UIPasteboard = plus.ios.importClass("UIPasteboard");
					var generalPasteboard = UIPasteboard.generalPasteboard();
					//设置/获取文本内容:
					generalPasteboard.plusCallMethod({
						setValue: copy,
						forPasteboardType: "public.utf8-plain-text"
					});
					generalPasteboard.plusCallMethod({
						valueForPasteboardType: "public.utf8-plain-text"
					});
					message("已成功复制到剪贴板");
				} else {
					//安卓
					var context = plus.android.importClass("android.content.Context");
					var main = plus.android.runtimeMainActivity();
					var clip = main.getSystemService(context.CLIPBOARD_SERVICE);
					plus.android.invoke(clip, "setText", copy);
					message("已成功复制到剪贴板");
				}
			}

			// 添加到通讯录
			function addAddressList() {
				plus.contacts.getAddressBook(plus.contacts.ADDRESSBOOK_PHONE, function(addressbook) {
					plus.nativeUI.confirm('确认将' + muiCont.contName + '（' + muiCont.phoneNum + '）添加到通讯录吗？', function(e) {
						if (e.index == 0) {
							var contact = addressbook.create();
							contact.name = {
								givenName: muiCont.contName
							};
							contact.phoneNumbers = [{
								type: "手机",
								value: muiCont.phoneNum,
								preferred: true
							}];
							contact.save(function() {
								message("添加成功");
							}, function() {
								message("添加失败");
							});
						} else {}
					}, {
						"title": "",
						"buttons": ["添加", "取消"],
						"verticalAlign": "bottom"
					});
				}, function(e) {
					message("添加失败");
				});
			}
		</script>
	</body>
</html>
