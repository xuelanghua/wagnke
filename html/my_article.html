<!doctype html>
<html>

	<head>
		<meta charset="utf-8">
		<title>我的文章</title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link href="../css/mui.min.css" rel="stylesheet" />
		<style type="text/css">
			.mui-btn-red {
				background-color: #ff6560;
			}

			.mui-btn-blue {
				background-color: #2289FF;
			}

			.mui-slider-handle {
				display: flex;
				align-items: flex-start;
				justify-content: space-between;
				position: relative;
			}

			.article-img-cont {
				width: 2.26rem;
				height: 1.6rem;
				overflow: hidden;
				flex-shrink: 0;
				margin-right: 0.2rem;
			}

			.article-img {
				width: 100%;
				height: auto;
			}

			.left-desc {
				display: block;
				flex-grow: 1;
			}

			.left-desc p {
				font-size: 0.3rem;
				color: #333333;
				line-height: 1.4;
			}

			.bottom-data {
				padding-left: 0.2rem;
				margin-top: 0.36rem;
			}

			.bottom-data span {
				font-size: 0.26rem;
				color: #999999;
			}

			.bottom-data img {
				width: 0.36rem;
				margin-right: 0.2rem;
			}

			.mui-content>.mui-table-view:first-child {
				margin-top: 0;
			}

			.mui-table-view:before {
				height: 0;
			}

			@-webkit-keyframes zoomIn {
				from {
					opacity: 0;
					-webkit-transform: scale3d(0.3, 0.3, 0.3);
					transform: scale3d(0.3, 0.3, 0.3);
				}

				50% {
					opacity: 1;
				}
			}

			@keyframes zoomIn {
				from {
					opacity: 0;
					-webkit-transform: scale3d(0.3, 0.3, 0.3);
					transform: scale3d(0.3, 0.3, 0.3);
				}

				50% {
					opacity: 1;
				}
			}

			/* 清除聊天记录 */
			.join-team-verify {
				position: fixed;
				z-index: 996;
				top: 0;
				bottom: 0;
				width: 100%;
				display: flex;
				align-items: center;
				justify-content: center;
				flex-direction: column;
			}


			.verift-body {
				width: 80%;
				background-color: #ffffff;
				border-radius: 10px;
				position: relative;
				overflow: hidden;
				padding-top: 5px;
				box-shadow: 0 0 5px 3px rgba(0, 0, 0, 0.2);
				animation: zoomIn 150ms ease-in-out;
			}

			.verift-body .tips {
				width: 100%;
				padding: 20px 10px 15px;
				text-align: justify;
			}

			.verift-footer:before {
				content: '';
				display: block;
				height: 1px;
				width: 100%;
				top: 0;
				left: 0;
				position: absolute;
				background-color: #dddddd;
				transform: scaleY(0.5);
				-webkit-transform: scaleY(0.5);
			}

			.verift-footer {
				position: relative;
				display: flex;
				justify-content: center;
			}

			.verift-footer .mui-btn {
				width: 100%;
				height: 100%;
				padding: 15px 10px;
			}

			.close-verify-window:before {
				content: '';
				display: block;
				height: 100%;
				width: 1PX;
				top: 0;
				bottom: 0;
				right: 0;
				position: absolute;
				background-color: #dddddd;
				transform: scaleX(0.5);
				-webkit-transform: scaleX(0.5);
			}
		</style>
	</head>

	<body class="mui-hidden">
		<header class="mui-bar mui-bar-nav">
			<div class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></div>
			<h1 class="mui-title">我的文章</h1>
		</header>

		<div id="mui-content" class="mui-content">
			<ul class="mui-table-view">
				<li id="index==1?'koutp':''" class="mui-table-view-cell" :data-article="article.id" v-for="(article,index) in articles"
				 :key="index">
					<div class="mui-slider-right mui-disabled">
						<span class="mui-btn mui-btn-red" @tap="delArticle(article.id)">删除</span>
						<span class="mui-btn mui-btn-blue" @tap="editArticle(article.id)">编辑</span>
					</div>
					<div class="mui-slider-handle">
						<div class="article-img-cont">
							<img class="article-img" :src="article.thumb" alt="">
						</div>
						<div class="left-desc">
							<p class="mui-ellipsis-2">{{article.title}}</p>
							<div class="bottom-data mui-clearfix">
								<span>{{article.add_time}}</span>
								<span class="mui-pull-right"><img src="../image//eye.png">{{article.click}}</span>
							</div>
						</div>
					</div>
				</li>
			</ul>
			<div class="join-team-verify" v-show="del">
				<div class="verift-body">
					<div class="tips">
						<span>文章删除之后将无法找回，是否继续？</span>
					</div>
					<div class="verift-footer">
						<button type="button" class="mui-btn mui-btn-link close-verify-window">取消</button>
						<button type="button" class="mui-btn mui-btn-link send-verify">确定</button>
					</div>
				</div>
			</div>
		</div>
		<script src="../js/mui.min.js"></script>
		<script src="../js/util.js"></script>
		<script type="text/javascript" src="../js/vue.min.js"></script>
		<script type="text/javascript">
			mui.init();
			var articleId = 0
			// 初始化字体大小
			var viewport = document.documentElement.clientWidth;
			if (viewport > 750) {
				viewport = 750
			}
			var userInfo = getUserInfo();
			document.documentElement.style.fontSize = viewport / 7.5 + "px";
			document.querySelector(".mui-hidden").classList.remove("mui-hidden");
			// 初始化字体大小结束
			mui.plusReady(function() {
				plus.webview.hide('article_operation', 'none');
				plus.webview.close('article_operation', 'none');
			})
			var app = new Vue({
				el: "#mui-content",
				data() {
					return {
						articles: [],
						articleStatus: true,
						del: false
					}
				},
				created: function() {
					mui.post($ajaxUrl + 'article', {
						token: userInfo.token,
						action: 'article_list',
						recommend: 1,
						hot: 0,
						cid: 0,
						skip: 1,
						limit: 10
					}, function(res) {
						if (res.errno == 0) {
							app.articles = res.data;
						} else {
							app.articleStatus = false;
						}
					}, 'json');
				},
				methods: {
					delArticle: function(arid) {
						// message(arid)
						articleId = arid;
						app.del = true;
					},
					editArticle: function(arid) {
						openPage('publish_article.html', 'publish_article', '#f7f7f7', {
							articleId: arid
						});
					}
				}
			})
			mui(".mui-content").on('tap', '.mui-table-view-cell', function() {
				var articleId = this.dataset.article;
				openPage('article.html', 'article', '#ffffff', {
					article_id: articleId
				});
			})
			mui(".mui-content").on("tap",".mui-pull-right",function(e){
				console.log("asdfasdf");
				e.stopPropagation();
			})
			// 取消删除
			mui(".mui-content").on('tap', '.close-verify-window', function() {
				app.del = false;
				var alex = document.querySelector('.mui-pull-right');
				mui.trigger(alex, 'tap');
			})
		</script>
	</body>

</html>
