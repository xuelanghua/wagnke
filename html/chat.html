<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title></title>
		<link href="../css/mui.min.css" rel="stylesheet" />
		<link href="../css/mui.indexedlist.css" rel="stylesheet" />
		<link href="../iconfont/iconfont.css" rel="stylesheet" />
		<style>
			html,
			body {
				height: 100%;
				overflow: hidden;
			}
			a:hover, a:active, a:visited, a:link, a:focus{
				-webkit-tap-highlight-color:rgba(0,0,0,0)!important;
				-webkit-tap-highlight-color: transparent!important;
				outline:none!important;
				background: none!important;
				text-decoration: none!important;
			}
			
			.clearfix{
				clear: both;
			}
			.mui-bar {
				height: 0;
			}
			.mui-search .mui-placeholder .mui-icon{
				color: #FFFFFF;
				margin-right: 5px;
			}
			.tite{
				padding: 15px 10px 48px 10px;
				/* background: linear-gradient(to right, #289cff , #1b75ff); */
				background-color: #2289FF;
			}
			.ns{
				margin-top: -7%;
			}
			.ns img{
				height: 22px;
			}
			.info{
				margin-right: 38px;
			}
			.nr{
				width: 100%;
				margin-top: -30px;
				padding: 0 10px;
			}
			.switch{
				padding: 15px 0;
				border-radius: 5px;
				box-shadow: 0 0 7px 0 #95bbfe;
				background-color: #FFFFFF;
			}
			.xuanz{
				color: #2289FF;
			}
			.switch1{
				width: 33%;
				float: left;
				text-align: center;
				border-right: 1px solid #F2F2F2;
			}
			.switch1_content{
				font-size: 14px;
				margin: 0 auto;
				padding: 7px 0;
			}
			.switch1_content img{
				height: 17px;
				position: relative;
				top: 3px;
				right: 3px;
			}
			.classify{
				width: 100%;
				margin-top: 10px;
				padding-bottom: 20px;
				background-color: #FFFFFF;
			}
			.classify1{
				width: 25%;
				float: left;
				font-size: 14px;
				margin-left: 5%;
				padding: 9px 0;
				margin-top: 15px;
				border-radius: 25px;
				background-color: #F5F6F8;
			}
			.classify1-content{
				text-align: center;
				margin: 0 auto;
			}
			.bian{
				color: #2288FF;
			}
			.classify1 img{
				height: 17px;
				position: relative;
				top: 3px;
				margin-right: 8px;
			}
			.classify1 i{
				position: relative;
				top: 1px;
				left: 1px;
				margin-right: 8px;
				color: #999999;
			}
			.label{
				background-color: #DEEDFF;
				/*border: 1px solid #3492FF;*/
			}
			.label i{
				position: relative;
				top: 1px;
				left: 1px;
				margin-right: 8px;
				color: #999999;
			}
			.bian i{
				color: #2288FF;
			}
			.head-portrait img{
				width: 45px;
				height: 45px;
				margin-top: 5px;
				border-radius: 50%;
			}
			.content{
				width: 80%;
			}
			.biaoqian button{
				padding: 2px 8px 0 8px;
				font-size: 10px;
				margin-top: 10px;
				border: none;
				color: #FFFFFF;
				border-radius: 10px;
				margin-right: 5px;
			}
			.firm{
				width: 30%;
				overflow: hidden;
				text-overflow:ellipsis;
				white-space: nowrap;
				background-color: #68B0FF;
			}
			.mui-table-view li{
				border-bottom: #F2F2F2;
			}
			
			.Birthday{
				font-size: 12px;
				color: #999999;
				margin-top: 10px;
			}
			
			/* 好友 */
			.good_friend{
				margin-top: 10px;
			}
			.good_friend_name{
				margin-top: 18px;
			}
			
			/* 新增客户 */
			.number{
				margin-top: 10px;
				padding: 12px 0 0 0;
				background-color: #FFFFFF;
			}
			.number_title{
				width: 90%;
				margin: 0 auto;
				padding-bottom: 10px;
				font-size: 12px;
			}
			.sign{
				width: 33.33%;
				float: left;
			}
			.sign_chart,.sign_chart1,.sign_chart2{
				width: 32px;
				height: 19px;
				display: block;
				border-radius: 5px;
				background-color: #68B0FF;
			}
			.sign_chart1{
				background-color: #F9D05E;
			}
			.sign_chart2{
				background-color: #FA5954;
			}
			.sign_name{
				margin-left: 5px;
			}
			
			.number_surface{
				text-align: center;
				margin-top: 19px;
			}
			.trapezium{
				width: 240px;
				border-bottom: 30px solid #68B0FF;
				border-left: 30px solid transparent;
				border-right: 30px solid transparent;
				transform:rotate(180deg);
				margin: 4px auto;
			}
			.trapezium_content{
				position: relative;
				top: -28px;
				font-size: 12px;
				color: #FFFFFF;
			}
			.trapezium1{
				width: 175px;
				border-bottom: 30px solid #F9D05E;
				border-left: 30px solid transparent;
				border-right: 30px solid transparent;
				transform:rotate(180deg);
				margin: -20px auto;
			}
			.trapezium_content1{
				position: relative;
				top: -5px;
				font-size: 12px;
				color: #FFFFFF;
			}
			.trapezium2{
				width: 110px;
				border-bottom: 30px solid #FA5954;
				border-left: 30px solid transparent;
				border-right: 30px solid transparent;
				transform:rotate(180deg);
				margin: 4px auto;
			}
			.trapezium_content2{
				position: relative;
				top: -30px;
				font-size: 12px;
				color: #FFFFFF;
			}
			
			.mui-card .mui-control-content {
				padding: 10px;
			}
			.mui-control-content {
				height: 100000000px;
			}
			.mui-segmented-control{
				border: none;
				background-color: #FFFFFF;
				border-radius: 0;
			}
			.mui-segmented-control .mui-control-item.mui-active {
				background-color: #FFFFFF;
				color: #2289FF;
				border-bottom: 2px solid #2289FF;
			}
			.mui-segmented-control .mui-control-item{
				border-left: none;
				font-size: 15px;
				color: #000000;
			}
			.newly_added{
				border-bottom: 1px solid #F2F2F2;
			}
			
			.chart{
				width: 70px;
				height: 70px;
			}
			.chart img{
				width: 100%;
				height: 100%;
				border-radius: 5px;
			}
			.customer_information{
				font-size: 12px;
			}
			.customer_information_name{
				font-size: 15px;
			}
			.customer_information img{
				width: 9px;
			}
			.customer-content{
				width: 76%;
				padding: 10px 0;
			}
			.mui-control-content {
				height: auto!important;
			}
			.mui-control-content .mui-table-view {
				margin-bottom: 120px!important;
			}
		</style>
	</head>

	<body>
		<header class="mui-bar">
		</header>
		<div class="mui-content">
			<div id='list' class="mui-indexed-list">
				<div class="tite">
					<div class="mui-indexed-list-search mui-input-row mui-search">
						<input type="search" id="search" class="mui-input-clear mui-indexed-list-search-input" placeholder="搜索">
					</div>
					<div class="mui-pull-right ns">
						<img class="info" id="message" src="../image/Message-icon.png" />
						<a href="javascript: void(0);" class="customer-edit" id="customer_edit">
							<img class src="../image/shuxie.png" />
						</a>
					</div>
				</div>
				<div class="nr">
					<div class="switch">
						<div class="switch1">
							<div class="switch1_content" data-id="customer">
								<i class="iconfont icon-friends"></i>
								<span>新增客户</span>
							</div>
						</div>
						<div class="switch1">
							<div class="switch1_content xuanz" data-id="crm">
								<i class="iconfont icon-custom"></i>
								<span>客户CRM</span>
							</div>
						</div>
						<div class="switch1" style="border-right: none;">
							<div class="switch1_content" data-id="friend">
								<i class="iconfont icon-friend"></i>
								<span>好友</span>
							</div>
						</div>
						<div class="clearfix"></div>
					</div>
				</div>
				<div class="mui-indexed-list-bar" style="height: 510px;display: block;" id="list_bar">
					<a>A</a>
					<a>B</a>
					<a>C</a>
					<a>D</a>
					<a>E</a>
					<a>F</a>
					<a>G</a>
					<a>H</a>
					<a>I</a>
					<a>J</a>
					<a>K</a>
					<a>L</a>
					<a>M</a>
					<a>N</a>
					<a>O</a>
					<a>P</a>
					<a>Q</a>
					<a>R</a>
					<a>S</a>
					<a>T</a>
					<a>U</a>
					<a>V</a>
					<a>W</a>
					<a>X</a>
					<a>Y</a>
					<a>Z</a>
				</div>
				<div class="mui-indexed-list-alert"></div>
				<div id="list_container">
				</div>
			</div>
		</div>

		<div id="crm" style="display: none">
			<div class="mui-indexed-list-inner">
				<div class="classify">
					<div class="classify1">
						<div class="classify1-content" data-label="deal">
							<span>
								<i class="iconfont icon-deal"></i>
							</span>
							<span>成交</span>
						</div>
					</div>
					<div class="classify1">
						<div class="classify1-content" data-label="follow">
							<span>
								<i class="iconfont icon-edit"></i>
							</span>
							<span>跟进中</span>
						</div>
					</div>
					<div class="classify1">
						<div class="classify1-content" data-label="member">
							<span>
								<i class="iconfont icon-diamond"></i>
							</span>
							<span>会员</span>
						</div>
					</div>
					<div class="classify1">
						<div class="classify1-content" data-label="job">
							<span>
								<i class="iconfont icon-position"></i>
							</span>
							<span>职位</span>
						</div>
					</div>
					<div class="classify1">
						<div class="classify1-content" data-label="care">
							<span>
								<i class="iconfont icon-people"></i>
							</span>
							<span>客情</span>
						</div>
					</div>
					<div class="classify1">
						<div class="classify1-content" data-label="label" id="label_edit">
							<span>
								<i class="iconfont icon-label"></i>
							</span>
							<span>标签</span>
						</div>
					</div>
					<div class="clearfix"></div>
				</div>
				<div class="mui-indexed-list-empty-alert">没有数据</div>
				<ul class="mui-table-view"></ul>
				<div style="width: 100%;height: 45px;line-height: 45px;text-align: center;margin-bottom: 100px;font-size: 15px;color: #999;"></div>
			</div>
		</div>
		<div id="customer" style="display: none;">
			<div class="mui-indexed-list-inner">
				<div class="number">
					<div class="number_title">
						<div>
							<div class="sign">
								<span class="sign_chart mui-pull-left"></span>
								<span class="sign_name">总用户数:<span class="customer_total">10</span></span>
								<div class="clearfix"></div>
							</div>
							<div class="sign">
								<span class="sign_chart1 mui-pull-left"></span>
								<span class="sign_name">跟进数量:<span class="customer_follow">3</span></span>
								<div class="clearfix"></div>
							</div>
							<div class="sign">
								<span class="sign_chart2 mui-pull-left"></span>
								<span class="sign_name">成交数量:<span class="customer_deal">0</span></span>
								<div class="clearfix"></div>
							</div>
							<div class="clearfix"></div>
						</div>
						<div class="number_surface">
							<div class="trapezium"></div>
							<div class="trapezium_content">用户总数:<span class="customer_total">50</span></div>
							<div class="trapezium1"></div>
							<div class="trapezium_content1">跟进数量:<span class="customer_follow">3</span></div>
							<div class="trapezium2"></div>
							<div class="trapezium_content2">成交数量:<span class="customer_deal">0</span></div>
						</div>
					</div>
				</div>
				<div class="newly_added">
					<div id="segmentedControl" class="mui-segmented-control">
						<a class="mui-control-item mui-active" href="#item1">新增客户</a>
						<a class="mui-control-item" href="#item2">跟进中</a>
						<a class="mui-control-item" href="#item3">高意向</a>
						<a class="mui-control-item" href="#item4">成交</a>
					</div>
				</div>
				<div class="list-container">
					<div id="item1" class="mui-control-content mui-active"></div>
					<div id="item2" class="mui-control-content"></div>
					<div id="item3" class="mui-control-content"></div>
					<div id="item4" class="mui-control-content"></div>
				</div>
			</div>
		</div>
		<div id="friend" style="display: none;">
			<div style="height: 60px;padding-left: 15px;padding-top: 10px;">
				<div class="mui-pull-left head-portrait">
					<img src="../image/add_friend_1.png">
				</div>
				<div class="mui-pull-left" style="margin-left: 18px;">
					<div class="good_friend_name">新朋友</div>
				</div>
			</div>
			<div class="mui-indexed-list-inner good_friend">
				<div class="mui-indexed-list-empty-alert">没有数据</div>
				<ul class="mui-table-view friends_detail"></ul>
				<div style="width: 100%;height: 45px;line-height: 45px;text-align: center;margin-bottom: 100px;font-size: 15px;color: #999;"></div>
			</div>
		</div>
		<script src="../js/mui.min.js"></script>
		<script src="../js/util.js"></script>
		<script src="../js/mui.indexedlist.js"></script>
		<script type="text/javascript" charset="utf-8">
			mui.init({
				swipeBack: false,
				beforeback: function() {
					return false;
				}
			});

			var label = null;
			var currentLabel = 'empty';
			var currentTab = 'crm';
			var userInfo = null;
			var customer_data = null;
			var timer = null;
			mui.plusReady(function() {
				userInfo = getUserInfo();
				pageInit();
				
				//自定义事件监听-首页新增客户点击
				window.addEventListener('newCustomer', function() {
					mui.trigger(document.querySelector('.switch1_content[data-id=customer]'), 'tap');
				})
				
				document.getElementById('label_edit').addEventListener('tap', function() {
					console.log(11111);
				})
				
				document.getElementById('message').addEventListener('tap', function() {
					fnOpenWin('message.html', 'message', {statusbar: {background: '#FFF'}}, {prePage: 'chat'}, 'slide-in-right');
					plus.navigator.setStatusBarStyle('dark');
				})
				
				document.querySelector('#customer_edit').addEventListener('tap', function() {
					if (currentTab == 'friend') {
						// fnOpenWin('')
					} else {
						fnOpenWin('customer_entry.html', 'customer_entry', {statusbar: {background: '#FFFFFF'}}, {cid: 0}, 'slide-in-right');
						plus.navigator.setStatusBarStyle('dark');
					}
				})
				
				window.addEventListener('addInterval', function(e) {
					console.log('addInterval');
					timeInterval();
				})
				
				window.addEventListener('addCustomer', function(e) {
					getCustomerList();
				})
				
				window.addEventListener('clearInterval', function(e) {
					console.log('claerInterval');
					clearTimeInterval();
				})
				
				window.addEventListener('loginSuccess', function(e) {
					console.log('loginSuccess');
					getCustomerList();
				})
			})

			function indexInit() {
				var header = document.querySelector('header.mui-bar');
				var list = document.getElementById('list');
				list.style.height = (document.body.offsetHeight - header.offsetHeight + 2) + 'px';
				window.indexedList = new mui.IndexedList(list);
				mui.trigger(document.getElementById(currentTab),'tap');
			}

			function pageInit() {
				// setTimeout('getCustomerList()', 20000);
				// localStorage.removeItem('customer');
				customer_data = JSON.parse(localStorage.getItem('customer'));
				if (!customer_data) {
					getCustomerList();
				} else {
					showCustomer(customer_data.crm, 'crm');
					var html = document.getElementById('crm').innerHTML;
					document.getElementById('list_container').innerHTML = html;
					eventInit();
					indexInit();
					showCustomer(customer_data.friend, 'friend');
					showCustomer(customer_data.customer, 'customer');
				}
			}
			
			function eventInit() {
				mui('.switch1').on('tap', '.switch1_content', function() {
					var id = this.dataset.id;
					if (id == currentTab) return;
					var tabObj = document.getElementsByClassName('switch1_content');
					mui.each(tabObj, function(index, item) {
						item.classList.remove('xuanz');
					})
					this.classList.add('xuanz');
					
					var html = document.getElementById(id).innerHTML;
					document.getElementById('list_container').innerHTML = html;
					if (id == 'customer') {
						document.getElementById('list_bar').style.display = "none";
						document.querySelector('.customer-edit').style.display = 'none';
					} else {
						document.getElementById('list_bar').style.display = "block";
						document.querySelector('.customer-edit').style.display = '';
						if (id == 'crm') {
							document.querySelector('.customer-edit img').src = '../image/shuxie.png';
						} else {
							document.querySelector('.customer-edit img').src = '../image/add_friend.png';
						}
					}
					if (id == 'crm' && currentLabel != 'empty') {
						var currentObj = document.querySelector('.classify1-content[data-label=' + currentLabel + ']');
						currentObj.parentElement.classList.add('label');
						currentObj.classList.add('bian');
					}
					eventInit();
					indexInit();
					currentTab = id;
				})
				
				mui('.classify1').on('tap', '.classify1-content', function() {
					label = this.dataset.label;
					if (label == 'label') {
						return;
					}
					var self = this;
					if (label == currentLabel) {
						self.parentElement.classList.remove('label');
						self.classList.remove('bian');
						label = null;
						currentLabel = 'empty';
						
						showCustomer(customer_data.crm, 'crm');
						var html = document.getElementById('crm').innerHTML;
						document.getElementById('list_container').innerHTML = html;
						eventInit();
						indexInit();
						return;
					}
					
					showCustomer(customer_data.crm, 'crm');
					var html = document.getElementById('crm').innerHTML;
					document.getElementById('list_container').innerHTML = html;
					eventInit();
					indexInit();
					
					var labelObj = document.getElementsByClassName('classify1-content');
					mui.each(labelObj, function(index, item) {
						item.classList.remove('bian');
						item.parentElement.classList.remove('label');
					});
					var currentObj = document.querySelector('.classify1-content[data-label=' + label + ']');
					currentObj.parentElement.classList.add('label');
					currentObj.classList.add('bian');
					currentLabel = label;
				})
				
				mui('.mui-indexed-list-item').on('tap', 'a', function() {
					var cid = this.dataset.id;
					var type = this.dataset.type;
					if (type == 'crm') {
						var from = this.dataset.from;
						if (from == 1) {
							fnOpenWin('crm_detail_miniapp.html', 'crm_detail_miniapp', {statusbar: {background: '#2289FF'}}, {cid: cid}, 'slide-in-right');
						} else {
							fnOpenWin('crm_detail_app.html', 'crm_detail_app', {statusbar: {background: '#2289FF'}}, {cid: cid}, 'slide-in-right');
						}
						
					} else if (type == 'friend') {
						var fid = this.dataset.id;
						fnOpenWin('friend_detail.html', 'friend_detail', {statusbar: {background: '#FFF'}}, {fid: fid, userId: fid}, 'slide-in-right');
					}
				})
				
				mui('.mui-table-view').on('tap', '.new-customer', function() {
					var cid = this.dataset.id;
					var type = this.dataset.type;
					fnOpenWin('customer_detail.html', 'customer_detail', {statusbar: {background: '#2289FF'}}, {cid: cid}, 'slide-in-right');
				})
				// 好友详情
				mui('.friends_detail').on('tap', '.mui-indexed-list-item', function() {
					var fid = this.dataset.id;
					fnOpenWin('friends_detail.html', 'friends_detail', {statusbar: {background: '#2289FF'}}, {fid: fid}, 'slide-in-right');
				})
			}

			function getCustomerList() {
				if (!userInfo) return;
				mui.post($ajaxUrl + 'customer', {
					action: 'list',
					token: userInfo.token
				}, function(res) {
					customer_data = res.data;
					localStorage.setItem('customer', JSON.stringify(customer_data));
					showCustomer(customer_data.crm, 'crm');
					showCustomer(customer_data.customer, 'customer');
					showCustomer(customer_data.friend, 'friend');
					var html = document.getElementById(currentTab).innerHTML;
					document.getElementById('list_container').innerHTML = html;
					eventInit();
					indexInit();
				}, 'json')
			}
			function showCustomer(data, type) {
				if (!data) return;
				if (type == 'crm') {
					var html = '';
					if (label == 'deal') {
						for (var index in data) {
							var list = data[index];
							var flag = false;
							var temp = '';
							for (var i in list) {
								if (list[i].mark == 2) {
									flag = true;
									temp += '<li data-value="' + list[i].pinyin + '" data-tags="' + list[i].pinyin + '" class="mui-table-view-cell mui-indexed-list-item">';
										temp += '<a href="javascript:void(0);" class="detail" data-type="crm" data-from="' + list[i].type +'" data-id="' + list[i].id + '">';
											temp += '<div class="mui-pull-left head-portrait">';
											if (list[i].headimgurl.length == 0) {
												temp += '<img src="../image/user_default.png">';
											} else {
												temp += '<img src="' + list[i].headimgurl + '">';
											}
											temp += '</div>';
											temp += '<div class="mui-pull-right content">';
												temp += '<div>';
													temp += '<span class="mui-pull-left" style="font-size: 15px;">';
														temp += '<span>' + list[i].name + '</span>';
														<!-- <span style="color: #3D94FF;">（' + list[i].name + '）</span> -->
													temp += '</span>';
													if (list[i].mark == 1) {
														temp += '<span class="mui-pull-right" style="font-size: 12px;color: #999999;margin-right: -10px;">[跟进中]</span>';
													} else if (list[i].mark == 2) {
														temp += '<span class="mui-pull-right" style="font-size: 12px;color: #999999;margin-right: -10px;">[成交]</span>';
													}
													temp += '<div class="clearfix"></div>';
												temp += '</div>';
												temp += '<div class="biaoqian">';
													temp += '<button class="firm">' + list[i].company + '</button>';
													temp += '<button style="background-color: #F9D05E;">' + list[i].job + '</button>';
													if (list[i].pid == list[i].recommend_id) {
														temp += '<button style="background-color: #F96B5E;">下级会员</button>';
													}
												temp += '</div>';
											temp += '</div>';
										temp += '</a>';
									temp += '</li>';
								}
								if (flag) {
									html += '<li data-group="' + index + '" class="mui-table-view-divider mui-indexed-list-group">' + index + '</li>';
									html += temp;
								}
							}
						}
					} else if (label == 'follow') {
						for (var index in data) {
							var list = data[index];
							var flag = false;
							var temp = '';
							for (var i in list) {
								if (list[i].mark == 1) {
									flag = true;
									temp += '<li data-value="' + list[i].pinyin + '" data-tags="' + list[i].pinyin + '" class="mui-table-view-cell mui-indexed-list-item">';
										temp += '<a href="javascript:void(0);" class="detail" data-type="crm" data-from="' + list[i].type +'" data-id="' + list[i].id + '">';
											temp += '<div class="mui-pull-left head-portrait">';
											if (list[i].headimgurl.length == 0) {
												temp += '<img src="../image/user_default.png">';
											} else {
												temp += '<img src="' + list[i].headimgurl + '">';
											}
											temp += '</div>';
											temp += '<div class="mui-pull-right content">';
												temp += '<div>';
													temp += '<span class="mui-pull-left" style="font-size: 15px;">';
														temp += '<span>' + list[i].name + '</span>';
														<!-- <span style="color: #3D94FF;">（' + list[i].name + '）</span> -->
													temp += '</span>';
													if (list[i].mark == 1) {
														temp += '<span class="mui-pull-right" style="font-size: 12px;color: #999999;margin-right: -10px;">[跟进中]</span>';
													} else if (list[i].mark == 2) {
														temp += '<span class="mui-pull-right" style="font-size: 12px;color: #999999;margin-right: -10px;">[成交]</span>';
													}
													temp += '<div class="clearfix"></div>';
												temp += '</div>';
												temp += '<div class="biaoqian">';
													temp += '<button class="firm">' + list[i].company + '</button>';
													temp += '<button style="background-color: #F9D05E;">' + list[i].job + '</button>';
													if (list[i].pid == list[i].recommend_id) {
														temp += '<button style="background-color: #F96B5E;">下级会员</button>';
													}
												temp += '</div>';
											temp += '</div>';
										temp += '</a>';
									temp += '</li>';
								}
								if (flag) {
									html += '<li data-group="' + index + '" class="mui-table-view-divider mui-indexed-list-group">' + index + '</li>';
									html += temp;
								}
							}
						}
					} else if (label == 'member') {
						for (var index in data) {
							var list = data[index];
							var flag = false;
							var temp = '';
							for (var i in list) {
								if (list[i].is_member == 1) {
									flag = true;
									temp += '<li data-value="' + list[i].pinyin + '" data-tags="' + list[i].pinyin + '" class="mui-table-view-cell mui-indexed-list-item">';
										temp += '<a href="javascript:void(0);" class="detail" data-type="crm" data-from="' + list[i].type +'" data-id="' + list[i].id + '">';
											temp += '<div class="mui-pull-left head-portrait">';
											if (list[i].headimgurl.length == 0) {
												temp += '<img src="../image/user_default.png">';
											} else {
												temp += '<img src="' + list[i].headimgurl + '">';
											}
											temp += '</div>';
											temp += '<div class="mui-pull-right content">';
												temp += '<div>';
													temp += '<span class="mui-pull-left" style="font-size: 15px;">';
														temp += '<span>' + list[i].name + '</span>';
														<!-- <span style="color: #3D94FF;">（' + list[i].name + '）</span> -->
													temp += '</span>';
													if (list[i].mark == 1) {
														temp += '<span class="mui-pull-right" style="font-size: 12px;color: #999999;margin-right: -10px;">[跟进中]</span>';
													} else if (list[i].mark == 2) {
														temp += '<span class="mui-pull-right" style="font-size: 12px;color: #999999;margin-right: -10px;">[成交]</span>';
													}
													temp += '<div class="clearfix"></div>';
												temp += '</div>';
												temp += '<div class="biaoqian">';
													temp += '<button class="firm">' + list[i].company + '</button>';
													temp += '<button style="background-color: #F9D05E;">' + list[i].job + '</button>';
													if (list[i].pid == list[i].recommend_id) {
														temp += '<button style="background-color: #F96B5E;">下级会员</button>';
													}
												temp += '</div>';
											temp += '</div>';
										temp += '</a>';
									temp += '</li>';
								}
								if (flag) {
									html += '<li data-group="' + index + '" class="mui-table-view-divider mui-indexed-list-group">' + index + '</li>';
									html += temp;
								}
							}
						}
					} else if (label == 'job') {
						for (var index in data) {
							var list = data[index];
							var flag = false;
							var temp = '';
							for (var i in list) {
								if (list[i].job.length != 0) {
									flag = true;
									temp += '<li data-value="' + list[i].pinyin + '" data-tags="' + list[i].pinyin + '" class="mui-table-view-cell mui-indexed-list-item">';
										temp += '<a href="javascript:void(0);" class="detail" data-type="crm" data-from="' + list[i].type +'" data-id="' + list[i].id + '">';
											temp += '<div class="mui-pull-left head-portrait">';
											if (list[i].headimgurl.length == 0) {
												temp += '<img src="../image/user_default.png">';
											} else {
												temp += '<img src="' + list[i].headimgurl + '">';
											}
											temp += '</div>';
											temp += '<div class="mui-pull-right content">';
												temp += '<div>';
													temp += '<span class="mui-pull-left" style="font-size: 15px;">';
														temp += '<span>' + list[i].name + '</span>';
														<!-- <span style="color: #3D94FF;">（' + list[i].name + '）</span> -->
													temp += '</span>';
													if (list[i].mark == 1) {
														temp += '<span class="mui-pull-right" style="font-size: 12px;color: #999999;margin-right: -10px;">[跟进中]</span>';
													} else if (list[i].mark == 2) {
														temp += '<span class="mui-pull-right" style="font-size: 12px;color: #999999;margin-right: -10px;">[成交]</span>';
													}
													temp += '<div class="clearfix"></div>';
												temp += '</div>';
												temp += '<div class="biaoqian">';
													// temp += '<button class="firm">' + list[i].company + '</button>';
													temp += '<button style="background-color: #F9D05E;">' + list[i].job + '</button>';
// 													if (list[i].pid == list[i].recommend_id) {
// 														temp += '<button style="background-color: #F96B5E;">下级会员</button>';
// 													}
												temp += '</div>';
											temp += '</div>';
										temp += '</a>';
									temp += '</li>';
								}
								if (flag) {
									html += '<li data-group="' + index + '" class="mui-table-view-divider mui-indexed-list-group">' + index + '</li>';
									html += temp;
								}
							}
						}
					} else if (label == 'label') {
						for (var index in data) {
							var list = data[index];
							var flag = false;
							var temp = '';
							for (var i in list) {
								if (list[i].label_id.length != 0) {
									flag = true;
									temp += '<li data-value="' + list[i].pinyin + '" data-tags="' + list[i].pinyin + '" class="mui-table-view-cell mui-indexed-list-item">';
										temp += '<a href="javascript:void(0);" class="detail" data-type="crm" data-from="' + list[i].type +'" data-id="' + list[i].id + '">';
											temp += '<div class="mui-pull-left head-portrait">';
											if (list[i].headimgurl.length == 0) {
												temp += '<img src="../image/user_default.png">';
											} else {
												temp += '<img src="' + list[i].headimgurl + '">';
											}
											temp += '</div>';
											temp += '<div class="mui-pull-right content">';
												temp += '<div>';
													temp += '<span class="mui-pull-left" style="font-size: 15px;">';
														temp += '<span>' + list[i].name + '</span>';
														<!-- <span style="color: #3D94FF;">（' + list[i].name + '）</span> -->
													temp += '</span>';
													if (list[i].mark == 1) {
														temp += '<span class="mui-pull-right" style="font-size: 12px;color: #999999;margin-right: -10px;">[跟进中]</span>';
													} else if (list[i].mark == 2) {
														temp += '<span class="mui-pull-right" style="font-size: 12px;color: #999999;margin-right: -10px;">[成交]</span>';
													}
													temp += '<div class="clearfix"></div>';
												temp += '</div>';
												temp += '<div class="biaoqian">';
												for (var j = 0; j < list[i].label.length && j < 5; j++) {
													temp += '<button style="background-color: #68B0FF;">' + list[i].label[j] + '</button>';
												}
												temp += '</div>';
											temp += '</div>';
										temp += '</a>';
									temp += '</li>';
								}
								if (flag) {
									html += '<li data-group="' + index + '" class="mui-table-view-divider mui-indexed-list-group">' + index + '</li>';
									html += temp;
								}
							}
						}
					} else if (label == 'care') {
						for (var index in data) {
							var list = data[index];
							var flag = false;
							var temp = '';
							for (var i in list) {
								if (list[i].birthday.length != 0 || list[i].anniversay.length != 0) {
									flag = true;
									temp += '<li data-value="' + list[i].pinyin + '" data-tags="' + list[i].pinyin + '" class="mui-table-view-cell mui-indexed-list-item">';
										temp += '<a href="javascript:void(0);" class="detail" data-type="crm" data-from="' + list[i].type +'" data-id="' + list[i].id + '">';
											temp += '<div class="mui-pull-left head-portrait">';
											if (list[i].headimgurl.length == 0) {
												temp += '<img src="../image/user_default.png">';
											} else {
												temp += '<img src="' + list[i].headimgurl + '">';
											}
											temp += '</div>';
											temp += '<div class="mui-pull-right content">';
												temp += '<div>';
													temp += '<span class="mui-pull-left" style="font-size: 15px;">';
														temp += '<span>' + list[i].name + '</span>';
														<!-- <span style="color: #3D94FF;">（' + list[i].name + '）</span> -->
													temp += '</span>';
													if (list[i].mark == 1) {
														temp += '<span class="mui-pull-right" style="font-size: 12px;color: #999999;margin-right: -10px;">[跟进中]</span>';
													} else if (list[i].mark == 2) {
														temp += '<span class="mui-pull-right" style="font-size: 12px;color: #999999;margin-right: -10px;">[成交]</span>';
													}
													temp += '<div class="clearfix"></div>';
												temp += '</div>';
												temp += '<div class="Birthday">';
												if (list[i].birthday.length != 0) {
													temp += '<span>';
														temp += '<span>生日：</span>';
														temp += '<span>' + list[i].birthday + '</span>';
													temp += '</span>';
												}
												if (list[i].anniversary.length != 0) {	
													temp += '<span style="margin-left: 15px;">';
														temp += '<span>纪念日：</span>';
														temp += '<span>' + list[i].anniversary + '</span>';
													temp += '</span>';
												}
												temp += '</div>';
											temp += '</div>';
										temp += '</a>';
									temp += '</li>';
								}
								if (flag) {
									html += '<li data-group="' + index + '" class="mui-table-view-divider mui-indexed-list-group">' + index + '</li>';
									html += temp;
								}
							}
						}
					} else {
						for (var index in data) {
							html += '<li data-group="' + index + '" class="mui-table-view-divider mui-indexed-list-group">' + index + '</li>';
							var list = data[index];
							for (var i in list) {
								html += '<li data-value="' + list[i].pinyin + '" data-tags="' + list[i].pinyin + '" class="mui-table-view-cell mui-indexed-list-item">';
									html += '<a href="javascript:void(0);" class="detail" data-type="crm" data-from="' + list[i].type + '" data-id="' + list[i].id + '">';
										html += '<div class="mui-pull-left head-portrait">';
										if (list[i].headimgurl.length == 0) {
											html += '<img src="../image/user_default.png">';
										} else {
											html += '<img src="' + list[i].headimgurl + '">';
										}
											
										html += '</div>';
										html += '<div class="mui-pull-right content">';
											html += '<div>';
												html += '<span class="mui-pull-left" style="font-size: 15px;">';
													html += '<span>' + list[i].name + '</span>';
													<!-- <span style="color: #3D94FF;">（' + list[i].name + '）</span> -->
												html += '</span>';
												if (list[i].mark == 1) {
													html += '<span class="mui-pull-right" style="font-size: 12px;color: #999999;margin-right: -10px;">[跟进中]</span>';
												} else if (list[i].mark == 2) {
													html += '<span class="mui-pull-right" style="font-size: 12px;color: #999999;margin-right: -10px;">[成交]</span>';
												}
												html += '<div class="clearfix"></div>';
											html += '</div>';
											html += '<div class="biaoqian">';
												html += '<button class="firm">' + list[i].company + '</button>';
												html += '<button style="background-color: #F9D05E;">' + list[i].job + '</button>';
												if (list[i].pid == list[i].recommend_id) {
													html += '<button style="background-color: #F96B5E;">下级会员</button>';
												}
											html += '</div>';
										html += '</div>';
									html += '</a>';
								html += '</li>';
							}
						}
					}
					if (html.length == 0) {
						html += '<div style="padding: 30px 15px;text-align: center;color: #ccc;padding-right: 45px;">没有数据</div>';
					}
					document.querySelector('#crm .mui-table-view').innerHTML = html;
				} else if (type == 'friend') {
					var html = '';
					for (var index in data) {
						html += '<li data-group="' + index + '" class="mui-table-view-divider mui-indexed-list-group">' + index + '</li>';
						var list = data[index];
						for (var i in list) {
							html += '<li data-value="' + list[i].pinyin + '" data-tags="' + list[i].pinyin + '" class="mui-table-view-cell mui-indexed-list-item">';
								html += '<a href="javascript:void(0);" class="detail" data-type="friend" data-id="' + list[i].fid + '">';
									html += '<div class="mui-pull-left head-portrait">';
									if (list[i].avatarUrl.length == 0) {
										html += '<img src="../image/user_default.png">';
									} else {
										html += '<img src="' + list[i].avatarUrl + '">';
									}
									html += '</div>';
									html += '<div class="mui-pull-right content">';
										html += '<div class="good_friend_name">' + list[i].name + '</div>';
									html += '</div>';
								html += '</a>';
							html += '</li>';
						}
					}
					if (html.length == 0) {
						html += '<div style="padding: 30px 15px;text-align: center;color: #ccc;padding-right: 45px;">没有数据</div>';
					}
					document.querySelector('#friend .mui-table-view').innerHTML = html;
				} else if (type == 'customer') {
					for (var index in data) {
						if (index == 'count') {
							var customerTotal = document.querySelectorAll('.customer_total'); 
							mui.each(customerTotal, function(sub, item) {
								item.innerHTML = data[index].total;
							})
							var customerFollow = document.querySelectorAll('.customer_follow');
							mui.each(customerFollow, function(sub, item) {
								item.innerHTML = data[index].follow;
							})
							var customerDeal = document.querySelectorAll('.customer_deal');
							mui.each(customerDeal, function(sub, item) {
								item.innerHTML = data[index].deal;
							})
							continue;
						}
						if (data[index].length != 0) {
							var list = data[index];
							html = '<ul class="mui-table-view">';
							for (var i in list) {
								html += '<li class="mui-table-view-cell new-customer" data-type="customer" data-id="' + list[i].id + '">';
								if (list[i].avatarUrl.length == 0) {
									html += '<div class="chart mui-pull-left"><img src="../image/user_default.png" ></div>';
								} else {
									html += '<div class="chart mui-pull-left"><img src="' + list[i].avatarUrl + '" ></div>';
								}
									html += '<div class="mui-pull-right customer-content">';
										html += '<div class="customer_information">';
											html += '<div class="mui-pull-left">';
											if (list[i].is_boss == 1) {
												html += '<span><img src="../image/bosi1.png" ></span>';
											}
												html += '<span class="customer_information_name">' + list[i].name + '</span>';
											html += '</div>';
											html += '<div class="mui-pull-right" style="color: #6A6A6A;">' + list[i].last_time + '前</div>';
											html += '<div class="clearfix"></div>';
										html += '</div>';
										html += '<div style="font-size: 12px;margin-top: 8px;">';
											html += '<span class="mui-pull-left">' + list[i].count + '次互动</span>';
											if (index == 'new') {
												html += '<span class="mui-pull-right"style="color: #4C7ABD;">进行中</span>';
											} else if (index == 'follow') {
												html += '<span class="mui-pull-right"style="color: #4C7ABD;">跟进中</span>';
											} else if (index == 'intention') {
												html += '<span class="mui-pull-right"style="color: #4C7ABD;">高意向</span>';
											} else if (index == 'deal') {
												html += '<span class="mui-pull-right"style="color: #4C7ABD;">完成</span>';
											}
										html += '</div>';
									html += '</div>';
								html += '</li>';
							}
							html += '</ul>';
						} else {
							html = '<div style="padding: 30px 15px;text-align: center;color: #ccc;padding-right: 45px;">没有数据</div>';
						}
						if (index == 'new') {
							document.getElementById('item1').innerHTML = html;
						} else if (index == 'follow') {
							document.getElementById('item2').innerHTML = html;
						} else if (index == 'intention') {
							document.getElementById('item3').innerHTML = html;
						} else if (index == 'deal') {
							document.getElementById('item4').innerHTML = html;
						}
					}
				}
			}
			
			function timeInterval() {
				timer = window.setInterval('getCustomerList()', 20000);
			}
			
			function clearTimeInterval() {
				window.clearInterval(timer);
			}
		</script>
	</body>

</html>
