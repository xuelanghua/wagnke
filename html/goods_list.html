<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover">
		<link href="../css/mui.css" rel="stylesheet" />
		<link href="../css/showLoading.css" rel="stylesheet" />
		<style>
			.clearfix{
				clear: both;
			}
			p{
				color: #333333;
			}
			.mui-bar{
				background-color: #FFFFFF;
			}
			.more{
				margin-top: 0.625rem;
				font-size: 0.9375rem;
				color: #333333;
			}
			.mui-popover{
				height: 0;
			}
			.mui-popover .mui-popover-arrow{
				top: -18px;
			}
			.mui-popover .mui-popover-arrow:after{
				background-color: #333333;
			}
			.mui-backdrop{
				/* background: none; */
				z-index: 12;
			}
			.nr{
				background: #333333;
				color: #FFFFFF;
			}
			
			.mui-content{
				padding: 0;
			}
			.search{
				margin: 0.625rem;
				padding: 0 10px;
				border-radius: 0.3125rem;
				border: 1px solid #DDDDDD;
				background-color: #FFFFFF;
			}
			.mui-icon{
				font-size: 20px;
			}
			.search input{
				width: 90%;
				margin: 0;
				border: none;
				padding: 3px;
				font-size: 0.875rem;
			}
			
			.mui-card .mui-control-content {
				padding: 10px;
			}
			.mui-segmented-control{
				border: none;
				background-color: #FFFFFF;
				border-radius: 0;
			}
			.mui-segmented-control .mui-control-item.mui-active {
				background-color: #FFFFFF;
				color: #F4CA3A;
				border-bottom: 2px solid #F4CA3A;
			}
			.mui-segmented-control .mui-control-item{
				border-left: none;
				font-size: 15px;
				color: #000000;
			}
			.newly_added{
				border-bottom: 1px solid #F2F2F2;
			}
			.chart{
				width: 1.6rem;
				height: 1.6rem;
				flex-shrink: 0;
				position: relative;
			}
			.chart img{
				width: 100%;
				height: 100%;
			}
			.customer_information{
				font-size: 14px;
			}
			
			
			.customer-content{
				flex-grow: 1;
				padding-left: 0.36rem;
				line-height: 1.5;
			}
			.genduo{
				background-color: #EAEBED;
				font-size: 20px;
				color: #8F8F8F;
				line-height: 5px;
				padding: 0 8px 10px 8px;
				border-radius: 10px;
				position: absolute;
				right: 0;
				z-index: 8;
			}
			.mui-table-view-cell{
				padding: 15px;
			}
			.playb{
				width: auto;
				position: absolute;
				padding: 10px 0 5px 0;
				right: 15%;
				border-radius: 5px;
				background-color: rgba(51,51,51,0.85);
				display: none;
				bottom: 5px;
				z-index: 80;
			}
			.jiao{
				width: 0;
				height: 0;
				border-top: 10px solid transparent;
				border-bottom: 7px solid transparent;
				border-left: 10px solid #515151;
				float: right;
				margin-top: 10px;
				margin-right: -9px;
			}
			.play{
				width: auto;
				color: #FFFFFF;
				font-size: 12px;
				float: left;
				margin-left: 5px;
				text-align: center;
				padding: 0 0.2rem;
				line-height: 1.6;
				position: relative;
			}
			.play:after{
				content: '';
				position: absolute;
				width: 1px;
				height: 30%;
				top: 35%;
				right: 0;
				background-color: #DDDDDD;
				-webkit-transform: scaleX(0.5);
				transform: scaleX(0.5);
				opacity: 0.2;
			}
			.play:last-of-type:after{
				display: none;
			}
			.play img{
				width: 16px;
				margin: 0;
			}
			.add_merchandise{
				width: 100%;
				position: fixed;
				bottom: 0;
				padding: 0;
				height: 1rem;
				border: none;
				border-radius: 0;
				font-size: 16px;
				background-color: #F4CA3A;
				color: #ffffff;
				z-index: 12;
				display: flex;
			}
			.add_merchandise button{
				background-color: transparent;
				border: none;
				color: #FFFFFF;
				width: 50%;
				margin: 0;
				padding: 0;
				display: inline-flex;
				height: 100%;
				font-size: 0.3rem;
				justify-content: center;
				position: relative;
			}
			.add_merchandise button:last-of-type:after{
				content: '';
				height: 40%;
				width: 1px;
				background-color: #f9f9f9;
				display: block;
				position: absolute;
				left: 0;
				top: 30%;
			}
			.add_merchandise button:active{
				background-color: transparent;
			}
			.mui-table-view-cell.mui-active{
				background: #FFFFFF;
			}
			
			.mui-search input {
				background-color: #fff;
				border-radius: 0.3125rem;
				border: 1px solid #DDD;
			}
			
			.tips-cont {
				width: 6.26rem;
				height: 7.9rem;
				display: flex;
				flex-direction: column;
				align-items: center;
			}
			
			.tips-cont .tips-body {
				display: flex;
				align-items: center;
				flex-direction: column;
				width: 6.26rem;
				height: 6.6rem;
				background: #ffffff url("../image/tips-top-bg.jpg")center top no-repeat;
				background-size: 100% auto;
				padding-top: 3.6rem;
				border-radius: 0.1rem;
			}
			
			.tips-cont .tips-body p {
				color: #333333;
				font-size: 0.3rem;
				margin-bottom: 0.9rem;
			}
			
			.tips-cont .tips-body .immediately {
				width: 3.86rem;
				height: 0.88rem;
				background-color: #f5ca3a;
				color: #FFFFFF;
				font-size: 0.36rem;
				line-height: 0.88rem;
				text-align: center;
				border-radius: 0.45rem;
			}
			.mui-table-view::before,.mui-table-view::after{
				height: 0;
			}
			.mui-table-view{
				background: transparent;
			}
			.mui-table-view-cell{
				background-color: #FFFFFF;
				display: flex;
				align-items: center;
			}
			.mui-bar-nav~.mui-content{
				padding-top: 135px;
				padding-bottom: 60px;
			}
			/* .mui-scroll{
				padding-bottom: 60px;
			} */
			.hot-sign {
				height: 0.24rem;
				width: auto;
				margin-right: 0.2rem;
			}
			.right-bottom-cont{
				display: flex;
				align-items: center;
				position: relative;
				color: #999999;
				font-size: 0.24rem;
			}
			.price-container{
				font-size: 0.24rem;
				padding: 0.1rem 0;
			}
			.right-bottom-cont span:first-of-type,
			.price-container span:first-of-type{
				margin-right: 0.44rem;
			}
			.price-container span:first-of-type{
				color: #F52E20;
			}
			/* 半透明效果 */
			/* .mui-table-view-cell.lucid-active{
				opacity: 0.5;
			} */
			.status-mask{
				position: absolute;
				top: 0;
				bottom: 0;
				width: 100%;
				background-color: rgba(0,0,0,0.6);
				display: flex;
				align-items: center;
				justify-content: center;
				color: #FFFFFF;
				font-size: 14px;
			}
			.status-mask.defeated{
				color: #FF0000;
			}
			.mui-control-item{
				touch-action: pan-y;
			}
			.mui-backdrop {
				 background-color: rgba(0,0,0,0);
			}
			/* 弹窗样式 */
			
			.mask-cont {
				position: fixed;
				width: 100%;
				top: 0;
				bottom: 0;
				display: flex;
				align-items: center;
				flex-direction: column;
				justify-content: center;
				background: rgba(0, 0, 0, .5);
				z-index: 9;
			}
			
			.tips-cont {
				width: 6.26rem;
				height: 7.9rem;
				display: flex;
				flex-direction: column;
				align-items: center;
			}
			
			.tips-cont .tips-body {
				display: flex;
				align-items: center;
				flex-direction: column;
				width: 6.26rem;
				height: 6.6rem;
				background: #ffffff url("../image/tips-top-bg.jpg")center top no-repeat;
				background-size: 100% auto;
				padding-top: 3.6rem;
				border-radius: 0.1rem;
			}
			
			.tips-cont .tips-body p {
				color: #333333;
				font-size: 0.3rem;
				margin-bottom: 0.9rem;
			}
			
			.tips-cont .tips-body .immediately {
				width: 3.86rem;
				height: 0.88rem;
				background-color: #f5ca3a;
				color: #FFFFFF;
				font-size: 0.36rem;
				line-height: 0.88rem;
				text-align: center;
				border-radius: 0.45rem;
			}
			[v-cloak] {
				display: none;
			}
		</style>
		<script type="text/javascript">
			var viewport = document.documentElement.clientWidth;
			if (viewport > 750) {
				viewport = 750
			}
			document.documentElement.style.fontSize = viewport / 7.5 + "px";
		</script>
	</head>
	<body id="body_tap">
		<header class="mui-bar mui-bar-nav">
			<div class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></div>
			<h1 class="mui-title">商品管理</h1>
		</header>
		<div class="mui-content mui-clearfix" id="mui-content" v-cloak>
			<div style="position: fixed;top:44px;z-index: 12;background-color: #F5F6F8;width: 100%;">
				<div class="mui-input-row mui-search" style="margin: 10px 10px -5px 10px;">
					<input type="search" class="mui-input-clear" v-model="goodsName" name="goods_name" placeholder="搜索商品名称">
				</div>
				<div class="newly_added">
					<div id="segmentedControl" class="mui-segmented-control">
						<a class="mui-control-item mui-active" data-type="on_sale" href="#item1">出售中(<span id="on_sale">0</span>)</a>
						<a class="mui-control-item" data-type="sale_out" href="#item2">售罄的(<span id="sale_out">0</span>)</a>
						<a class="mui-control-item" data-type="off_sale" href="#item3">仓库中(<span id="off_sale">0</span>)</a>
					</div>
				</div>
			</div>
			<div id="goods_container" class="goods-container">
				<div id="item1" class="mui-control-content mui-active">
					<div class="mui-scroll-wrapper">
						<div class="mui-scroll">
							<ul class="mui-table-view" id="item1_list">
								<li class="mui-table-view-cell" :class="lst.check_status==1?'':'lucid-active'" v-for="(lst,i) in on_sale_list"
								 :key="i">
									<div class="chart" @tap="openGoodsDetail(lst.id,lst.is_team_goods)">
										<div v-if="lst.check_status==0" class="status-mask">
											审核中
										</div>
										<div v-else-if="lst.check_status==2" class="status-mask defeated">
											审核失败
										</div>
										<img :src="lst.cover">
									</div>
									<div class="customer-content">
										<div class="customer_information mui-ellipsis-2" @tap="openGoodsDetail(lst.id,lst.is_team_goods)">
											{{lst.name}}
										</div>
										<div class="price-container" @tap="openGoodsDetail(lst.id,lst.is_team_goods)">
											<span>&yen;{{lst.price}}</span>
										</div>
										<div class="right-bottom-cont">
											<!-- <span>销量：{{lst.sale_count}}</span> -->
											<span @tap="openGoodsDetail(lst.id,lst.is_team_goods)">库存：{{lst.stock}}</span>
											<span v-if="lst.is_team_goods==1" @tap="openGoodsDetail(lst.id,lst.is_team_goods)">分销商品</span>
											<span class="genduo" :data-ids="lst.id">...</span>
										</div>
										<div class="playb mui-clearfix" :class="'playb'+lst.id">
											<div class="jiao"></div>
											<div v-if="(lst.is_team_goods==1&&lst.check_status==1)||lst.is_team_goods==0" class="play" data-type="edit" :data-gtype="lst.is_team_goods">
												<img src="../image/edit.png" />
												<div>编辑</div>
											</div>
											<div class="play" data-type="off" :data-gtype="lst.is_team_goods">
												<img src="../image/lower_shelf.png" />
												<div>下架</div>
											</div>
											<!-- <div class="play" data-type="jh" :data-gtype="lst.is_team_goods">
												<img src="../image/icon/qyecjh-icon.png" />
												<div>拣货</div>
											</div> -->
											<div class="play" data-type="del" :data-gtype="lst.is_team_goods">
												<img src="../image/delete.png" />
												<div style="margin-top: -1px;">删除</div>
											</div>
										</div>
									</div>
								</li>
								<div v-if="on_sale_status">
									<img style="width: 60%;display: block;margin: 20% auto 0;" class="no-friends" src="../image/icon/void-goods.png">
									<p style="text-align: center;color:#717171;">暂无商品</p>
								</div>
							</ul>
						</div>
					</div>
				</div>
				<div id="item2" class="mui-control-content">
					<div class="mui-scroll-wrapper">
						<div class="mui-scroll">
							<ul class="mui-table-view" id="item2_list">
								<li class="mui-table-view-cell" :class="slo.check_status==1?'':'lucid-active'" v-for="(slo,idx) in sale_out_list"
								 :key="idx">
									<div class="chart" @tap="openGoodsDetail(slo.id,slo.is_team_goods)">
										<div v-if="slo.check_status==0" class="status-mask">
											审核中
										</div>
										<div v-else-if="slo.check_status==2" class="status-mask defeated">
											审核失败
										</div>
										<img :src="slo.cover">
									</div>
									<div class="customer-content">
										<div class="customer_information mui-ellipsis-2" @tap="openGoodsDetail(slo.id,slo.is_team_goods)">
											{{slo.name}}
										</div>
										<div class="price-container" @tap="openGoodsDetail(slo.id,slo.is_team_goods)">
											<!-- <span>提成：&yen;{{slo.commission}}</span> -->
											<span>&yen;{{slo.price}}</span>
										</div>
										<div class="right-bottom-cont">
											<!-- <span>销量：{{lst.sale_count}}</span> -->
											<span @tap="openGoodsDetail(slo.id,slo.is_team_goods)">库存：{{slo.stock}}</span>
											<span v-if="slo.is_team_goods==1" @tap="openGoodsDetail(slo.id,slo.is_team_goods)">分销商品</span>
											<span class="genduo" :data-ids="slo.id">...</span>
										</div>
										<div class="playb mui-clearfix" :class="'playb'+slo.id">
											<div class="jiao"></div>
											<div v-if="(slo.is_team_goods==1&&slo.check_status==1)||slo.is_team_goods==0" class="play" data-type="edit" :data-gtype="slo.is_team_goods">
												<img src="../image/edit.png" />
												<div>编辑</div>
											</div>
											<div class="play" data-type="off" :data-gtype="slo.is_team_goods">
												<img src="../image/lower_shelf.png" />
												<div>下架</div>
											</div>
											<div class="play" data-type="on" :data-gtype="slo.is_team_goods">
												<img src="../image/on_sale.png" />
												<div>上架</div>
											</div>
											<div class="play" data-type="del" :data-gtype="slo.is_team_goods">
												<img src="../image/delete.png" />
												<div style="margin-top: -1px;">删除</div>
											</div>
										</div>
									</div>
								</li>
								<div v-if="sale_out_status">
									<img style="width: 60%;display: block;margin: 20% auto 0;" class="no-friends" src="../image/icon/void-goods.png">
									<p style="text-align: center;color:#717171;">暂无商品</p>
								</div>
							</ul>
						</div>
					</div>
				</div>
				<div id="item3" class="mui-control-content">
					<div class="mui-scroll-wrapper">
						<div class="mui-scroll">
							<ul class="mui-table-view" id="item3_list">
								<li class="mui-table-view-cell" :class="lst.check_status==1?'':'lucid-active'" v-for="(lst,sign) in off_sale_list"
								 :key="sign">
									<div class="chart" @tap="openGoodsDetail(lst.id,lst.is_team_goods)">
										<div v-if="lst.check_status==0" class="status-mask">
											审核中
										</div>
										<div v-else-if="lst.check_status==2" class="status-mask defeated">
											审核失败
										</div>
										<img :src="lst.cover">
									</div>
									<div class="customer-content">
										<div class="customer_information mui-ellipsis-2" @tap="openGoodsDetail(lst.id,lst.is_team_goods)">
											{{lst.name}}
										</div>
										<div class="price-container"  @tap="openGoodsDetail(lst.id,lst.is_team_goods)">
											<!-- <span>提成：&yen;{{lst.commission}}</span> -->
											<span>&yen;&nbsp;{{lst.price}}</span>
										</div>
										<div class="right-bottom-cont">
											<!-- <span>销量：{{lst.sale_count}}</span> -->
											<span  @tap="openGoodsDetail(lst.id,lst.is_team_goods)">库存：{{lst.stock}}</span>
											<span v-if="lst.is_team_goods==1" @tap="openGoodsDetail(lst.id,lst.is_team_goods)">分销商品</span>
											<span class="genduo" :data-ids="lst.id">...</span>
										</div>
										<div class="playb mui-clearfix" :class="'playb'+lst.id">
											<div class="jiao"></div>
											<div v-if="(lst.is_team_goods==1&&lst.check_status==1)||lst.is_team_goods==0" class="play" data-type="edit" :data-gtype="lst.is_team_goods">
												<img src="../image/edit.png" />
												<div>编辑</div>
											</div>
											<div class="play" data-type="on" :data-gtype="lst.is_team_goods">
												<img src="../image/on_sale.png" />
												<div>上架</div>
											</div>
											<div class="play" data-type="del" :data-gtype="lst.is_team_goods">
												<img src="../image/delete.png" />
												<div style="margin-top: -1px;">删除</div>
											</div>
										</div>
									</div>
								</li>
								<div v-if="off_sale_status">
									<img style="width: 60%;display: block;margin: 20% auto 0;" class="no-friends" src="../image/icon/void-goods.png">
									<p style="text-align: center;color:#717171;">暂无商品</p>
								</div>
							</ul>
						</div>
					</div>
				</div>
			</div>
			<div class="add_merchandise" id="add_merchandise">
				<button id="add_goods">添加商品</button>
				<button id="stock_goods">拣货</button>
			</div>
		</div>
		<div class="mask-cont mui-hidden">
			<div class="tips-cont">
				<div class="tips-body">
					<p>您的商品位已达上限，请购买更多商品位</p>
					<span class="immediately">立即购买</span>
				</div>
				<img class="hide_qrcode" src="../image/Close.png" style="width: 28px;height: 28px;margin-top: 30px;">
			</div>
		</div>
	</body>
</html>
<script src="../js/mui.js"></script>
<script src="../js/util.js"></script>
<script src="../js/vue.min.js"></script>
<script type="text/javascript">
	var userInfo = getUserInfo();
	var mask = mui.createMask(function() {
		document.querySelector(".playb" + currentId).style.display = 'none';
	});
	var g_type = 'on_sale',
		skip = 1,
		limit = 8,
		currentId = '';
	var app = new Vue({
		el: "#mui-content",
		data: {
			goodsName: '',
			on_sale_list: [],
			sale_out_list: [],
			off_sale_list: [],
			on_sale_status: false,
			sale_out_status: false,
			off_sale_status: false,
		},
		created: function() {
			// 初始化字体大小
			var viewport = document.documentElement.clientWidth;
			if (viewport > 750) {
				viewport = 750
			}
			document.documentElement.style.fontSize = viewport / 7.5 + "px";
			// 初始化字体大小结束	
		},
		methods: {
			openGoodsDetail: function(gid, type) {
				if (type == 0) {
					openPage('distributor_goods_detail_bio.html', 'distributor_goods_detail_bio', '#f7f7f7', {
						gid: gid
					})
				} else {
					openPage('distributor_goods_detail_mine.html', 'distributor_goods_detail_mine', '#f7f7f7', {
						gid: gid
					})
				}
			}
		},
		mounted: function() {
			mui.init({
				swipeBack: false,
				pullRefresh: {
					container: "#goods_container",
					up: {
						height: 50,
						auto: false,
						contentrefresh: "正在加载...",
						contentnomore: '没有更多数据了',
						callback: function() {
							skip += 1;
							getGoodsList('up');
						}
					},
					down: {
						style: 'circle',
						color: '#2289FF',
						height: '50px',
						range: '100px',
						offset: '0px',
						auto: false,
						callback: function() {
							skip = 1;
							getGoodsCount();
							getGoodsList('down');
						}
					}
				}
			});
			getGoodsCount();
			eventInit();
			mui.plusReady(function() {
				window.addEventListener('goodsAddSuccess', function() {
					getGoodsList(false);
				})
				getGoodsList(false);
			})
		}
	})

	function eventInit() {
		// 搜索
		document.onkeydown = function(event) {
			var e = event || window.event || arguments.callee.caller.arguments[0];
			if (e && e.keyCode == 13) { // enter 键
				getGoodsList();
			}
		};
		//展示商品弹窗
		mui(".mui-table-view").on('tap', '.genduo', function(e) {
			var glist = document.querySelectorAll(".playb");
			for (i = 0; i < glist.length; i++) {
				glist[i].style.display = "none";
			}
			currentId = this.dataset.ids;
			document.querySelector(".playb" + currentId).style.display = 'block';
			mask.show();
			e.stopPropagation();
		})
		//点击窗口关闭商品操作弹窗
		// document.addEventListener('tap', function() {
		// 	mui('.playb').each(function() {
		// 		this.style.display = 'none';
		// 	})
		// })
		mui('.mui-content').on('tap', '.play', function(e) {
			var type = this.dataset.type;
			// 是否团队商品
			var gtype = this.dataset.gtype;
			mask.close();
			if (type == 'off') {
				//下架按钮
				// "team_goods"
				if (gtype == 1) {
					changeGoodsStatus(0, currentId, "team_goods");
				} else {
					changeGoodsStatus(0, currentId);
				}
			} else if (type == 'on') {
				//上架按钮
				if (gtype == 1) {
					changeGoodsStatus(1, currentId, "team_goods");
				} else {
					changeGoodsStatus(1, currentId);
				}
			} else if (type == 'del') {
				//删除框
				plus.nativeUI.confirm('确认删除该商品?', function(e) {
					if (e.index == 0) {
						if (gtype == 1) {
							changeGoodsStatus(-1, currentId, "team_goods");
							getGoodsCount();
						} else {
							changeGoodsStatus(-1, currentId);
							getGoodsCount();
						}
					}
				})
			} else if (type == 'edit') {
				if (gtype == 1) {
					//打开编辑页面
					openPage('edit_distribution_goods_again.html', 'edit_distribution_goods_again', '#f7f7f7', {
						gid: currentId
					})
				} else {
					//打开编辑页面
					mui.openWindow({
						id: 'goods_edit',
						url: 'goods_edit.html',
						show: {
							aniShow: 'slide-in-right'
						},
						extras: { //extras里面的就是参数了
							goods_id: currentId
						},
						styles: {
							statusbar: {
								background: '#FFF',
							},
						}
					});
				}
			}
		})
		//添加商品
		document.getElementById('add_goods').addEventListener('tap', function() {
			mui.get($ajaxUrl + 'member', {
				action: 'check_goods_number',
				token: userInfo.token
			}, function(res) {
				// logs(res); 
				if (res.errno == 0) {
					fnOpenWin('goods_add.html', 'goods_add', {
						statusbar: {
							background: '#FFF'
						}
					}, '', 'slide-in-right');
				} else {
					document.querySelector(".mask-cont").classList.remove('mui-hidden');
				}
			}, 'json');
		})
		// 拣货
		document.getElementById('stock_goods').addEventListener('tap', function() {
			openPage('choose_goods.html', 'choose_goods', '#ffffff');
		})
		// 立即购买商品位
		mui(".mask-cont").on("tap", ".immediately", function() {
			document.querySelector(".mask-cont").classList.add('mui-hidden');
			openPage("buy_goods_booth.html", 'buy_goods_booth', '#f7f7f7', '');
		})
		// 关闭提示弹窗
		mui(".mask-cont").on("tap", ".hide_qrcode", function() {
			document.querySelector(".mask-cont").classList.add('mui-hidden');
		})
	}
	//获取商品列表
	function getGoodsList(refresh) {
		mui.post($ajaxUrl + 'goods', {
			action: 'all_goods_list',
			token: userInfo.token,
			type: g_type,
			skip: skip,
			limit: 8,
			goods_name: app.goodsName
		}, function(res) {
			// logs(res);
			if (res.errno == 0) {
				if (skip == 1) {
					app[g_type + '_list'] = res.data;
				} else {
					app[g_type + '_list'] = app[g_type + '_list'].concat(res.data);
				}
				
				if (res.extra.has_more) {
					mui('#goods_container').pullRefresh().endPullupToRefresh(false);
				} else {
					mui('#goods_container').pullRefresh().endPullupToRefresh(true);
				}
				app[g_type + '_status'] = false;
			} else {
				if (skip == 1) {
					app[g_type + '_list'] = [];
					app[g_type + '_status'] = true;
				}
				mui('#goods_container').pullRefresh().endPullupToRefresh(true);
			}
			
			if (refresh == "down") {
				mui('#goods_container').pullRefresh().endPulldownToRefresh();
			}
		}, 'json');
	}
	// 切换选项卡
	mui(".mui-content").on("tap", ".mui-control-item", function() {
		g_type = this.dataset.type;
		skip = 1;
		// getGoodsCount();
		getGoodsList();
	})
	//改变商品状态
	function changeGoodsStatus(status, goods_id, type) {
		mui.post($ajaxUrl + 'goods', {
			action: 'change_status',
			token: userInfo.token,
			status: status,
			goods_id: goods_id,
			type: type //是否团队商品 
		}, function(res) {
			// logs(res);
			if (res.errno == 0) {
				skip = 1;
				getGoodsCount();
				getGoodsList();
				message('操作成功!');
			} else {
				message(res.message);
			}
		}, 'json');
	}
	// 取消搜索
	mui('.mui-content').on('tap', '.mui-icon-clear', function() {
		app.goodsName = '';
		getGoodsList();
	})
	// 数量统计
	function getGoodsCount() {
		mui.post($ajaxUrl + 'goods&action=all_goods_count', {
			token: userInfo.token,
		}, function(res) {
			if (res.errno == 0) {
				mui('#on_sale')[0].innerText = res.data.on_sale;
				mui('#sale_out')[0].innerText = res.data.sale_out;
				mui('#off_sale')[0].innerText = res.data.off_sale;
			} else {
				mui('#on_sale')[0].innerText = 0;
				mui('#sale_out')[0].innerText = 0;
				mui('#off_sale')[0].innerText = 0;
			}
		}, 'json');
	}
	// 监听编辑
	window.addEventListener('reloadYourself', function() {
		getGoodsCount();
		getGoodsList();
	})
	// 判断软键盘是否弹起
	/* var originalHeight = document.documentElement.clientHeight || document.body.clientHeight;
	window.onresize = function() {
		//软键盘弹起与隐藏  都会引起窗口的高度发生变化
		var resizeHeight = document.documentElement.clientHeight || document.body.clientHeight;
		var paddeds = document.getElementById("add_merchandise");
		var focus = document.querySelector('input:focus');
		if (resizeHeight * 1 < originalHeight * 1 && focus) {
			paddeds.style.display = 'none';
		} else {
			paddeds.style.display = 'flex';
		}
	} */
</script>
